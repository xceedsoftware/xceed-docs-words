"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[5610],{41558:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var a=t(74848),n=t(28453),s=t(11470),i=t(19365);const l={},o="Extracting items from a Tar archive with QuickTar",c={id:"code-snippets/tar-gzip-capabilities/reading/extract-tar-quicktar",title:"Extracting items from a Tar archive with QuickTar",description:"This topic demonstrates how to extract items from a Tar archive using the static Untar method of the QuickTar class, specifying several parameters.",source:"@site/zip/code-snippets/tar-gzip-capabilities/reading/extract-tar-quicktar.md",sourceDirName:"code-snippets/tar-gzip-capabilities/reading",slug:"/code-snippets/tar-gzip-capabilities/reading/extract-tar-quicktar",permalink:"/xceed-libs-doc/zip/code-snippets/tar-gzip-capabilities/reading/extract-tar-quicktar",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarzip",previous:{title:"Extracting a Tar/BZip2 archive",permalink:"/xceed-libs-doc/zip/code-snippets/tar-gzip-capabilities/reading/extract-tarbzip2"},next:{title:"Listing the contents of a Tar archive with QuickTar",permalink:"/xceed-libs-doc/zip/code-snippets/tar-gzip-capabilities/reading/listing-tar-quicktar"}},u={},d=[{value:"Untar method",id:"untar-method",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Handling paths",id:"handling-paths",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Things you should consider",id:"things-you-should-consider",level:2}];function h(e){const r={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"extracting-items-from-a-tar-archive-with-quicktar",children:"Extracting items from a Tar archive with QuickTar"})}),"\n",(0,a.jsx)(r.p,{children:"This topic demonstrates how to extract items from a Tar archive using the static Untar method of the QuickTar class, specifying several parameters."}),"\n",(0,a.jsx)(r.admonition,{type:"note",children:(0,a.jsx)(r.p,{children:"Tar is not currently available in Xceed's Compact Framework products."})}),"\n",(0,a.jsx)(r.h2,{id:"untar-method",children:"Untar method"}),"\n",(0,a.jsx)(r.p,{children:"The Untar method has a few overloads that can be used to extract files from a Tar archive. Some only require that you specify the archive name and the files to extract, the destination folder, and whether the Tar archive is compressed by GZip, while others provide options such as whether existing files should be replaced and the directory structure preserved in the destination Tar archive, whether the Tar operation should be performed recursively. Events are also supported."}),"\n",(0,a.jsx)(r.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,a.jsx)(r.p,{children:"In the following example, we specify several parameters and also use some callbacks."}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'  QuickTar.Untar(@"d:\\test.tar", @"d:\\output\\", true, true, true, true,\r\n           new QuickTar.ByteProgressionCallback(this.OnByteProgression),\r\n           new QuickTar.ItemProgressionCallback(this.OnItemProgression),\r\n           null, @"*");\r\n\r\n  public void OnByteProgression( string currentItemName, long currentItemsByteProcessed,\r\n                                long currentItemTotalBytes, byte currentItemPercent,\r\n                                long allItemsByteProcessed, long allItemsTotalBytes,\r\n                                byte allItemsPercent, object userParams)\r\n  { \r\n    //Do stuff\r\n  }\r\n\r\n  public void OnItemProgression( string currentItemName,\r\n                                long itemProcessed, \r\n                                long totalItemCount, \r\n                                byte totalItemPercent, \r\n                                ref bool abort, \r\n                                object userParams)\r\n  {\r\n    //Do stuff\r\n  }\n'})})}),(0,a.jsx)(i.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-vb.NET",children:'  QuickTar.Untar("d:\\test.tar", "d:\\output\\", True, True, True, _\r\n           True, New QuickTar.ByteProgressionCallback(Me.OnByteProgression), _\r\n           New QuickTar.ItemProgressionCallback(Me.OnItemProgression), _\r\n           Nothing, "*")  \r\n\r\n  Public Sub OnByteProgression(ByVal currentItemName As String, _\r\n                              ByVal currentItemsByteProcessed As Long, _\r\n                              ByVal currentItemTotalBytes As Long, _ \r\n                              ByVal currentItemPercent As Byte, _\r\n                              ByVal allItemsByteProcessed As Long, _\r\n                              ByVal allItemsTotalBytes As Long, _\r\n                              ByVal allItemsPercent As Byte, _\r\n                              ByVal userParams As Object) \r\n    \'Do stuff\r\n  End Sub\r\n\r\n  Public Sub OnItemProgression(ByVal currentItemName As String, _\r\n                              ByVal itemProcessed As Long, _\r\n                              ByVal totalItemCount As Long, _\r\n                              ByVal totalItemPercent As Byte, _\r\n                              ByRef abort As Boolean, _\r\n                              ByVal userParams As Object)\r\n    \' Do stuff\r\n  End Sub\n'})})})]}),"\n",(0,a.jsx)(r.h2,{id:"handling-paths",children:"Handling paths"}),"\n",(0,a.jsx)(r.p,{children:"When extracting files from within a Tar archive file, the directory structure can be restored fully or partrially, or it can be omitted altogether."}),"\n",(0,a.jsxs)(r.p,{children:["If the ",(0,a.jsx)(r.code,{children:"preservePaths"})," parameter of the Untar method is set to ",(0,a.jsx)(r.strong,{children:"false"}),", the files specified in the ",(0,a.jsx)(r.em,{children:"filesToUntar"})," parameter will be restored directly into the root of the destination folder without recreating the directory structure."]}),"\n",(0,a.jsx)(r.p,{children:'For example, if you have a Tar archive containing files in the "folder1" subfolder and files in the "folder1\\folder2" subfolder, the following code will untar all files right into "c:\\temp", without creating any subfolders:'}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'  QuickTar.Untar( @"c:\\test.tar", @"c:\\temp", true, true, false, @"folder1\\*" );\n'})})}),(0,a.jsx)(i.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-vb.NET",children:'  QuickTar.Untar( "c:\\test.tar", "c:\\temp", True, True, False, "folder1\\*" )\n'})})})]}),"\n",(0,a.jsxs)(r.p,{children:["If however the ",(0,a.jsx)(r.em,{children:"preservePaths"})," parameter is set to ",(0,a.jsx)(r.strong,{children:"true"}),", the part of the path that is explicitly included in the ",(0,a.jsx)(r.em,{children:"filesToUntar"})," parameter will not be restored into the destination folder."]}),"\n",(0,a.jsx)(r.p,{children:'For example, for the same Tar archive as above, the following code will create the folder "folder2" into the "c:\\temp" destination folder. Files that were in the "folder1" subfolder in the archive will be extracted directly into the root of "c:\\temp", and files that were in "folder1\\folder2" will be extracted into "c:\\temp\\folder2":'}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'  QuickTar.Untar( @"c:\\test.tar", @"c:\\temp", true, true, true, @"folder1\\*" );\n'})})}),(0,a.jsx)(i.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-vb.NET",children:'  QuickTar.Untar( "c:\\test.tar", "c:\\temp", True, True, True, "folder1\\*" )\n'})})})]}),"\n",(0,a.jsx)(r.p,{children:'The following example will extract files into "c:\\temp\\folder1" and "c:\\temp\\folder1\\folder2":'}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-csharp",children:'  QuickTar.Untar( @"c:\\test.tar", @"c:\\temp", true, true, true, @"*" );\n'})})}),(0,a.jsx)(i.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-vb.NET",children:'  QuickTar.Untar( "c:\\test.tar", "c:\\temp", True, True, True, "*" )\n'})})})]}),"\n",(0,a.jsx)(r.h2,{id:"remarks",children:"Remarks"}),"\n",(0,a.jsxs)(r.p,{children:["When recursively adding files to a zip file, you have to consider every filename you place in the filesToTar parameter as a filemask. For example, if you set the ",(0,a.jsx)(r.em,{children:"filesToTar"}),' parameter to "c:\\file.txt", the ',(0,a.jsx)(r.strong,{children:"entire"}),' "c:" drive will be scanned and all the files that are named "file.txt" that are found will be included in the Tar archive.']}),"\n",(0,a.jsxs)(r.p,{children:["Note that the ",(0,a.jsx)(r.em,{children:"filesToTar"})," parameter of the Tar method cannot be null; otherwise, an ArgumentNullException exception will be thrown."]}),"\n",(0,a.jsxs)(r.p,{children:["If the ",(0,a.jsx)(r.em,{children:"isTarCompressed"})," parameter is set to true, the GZip file retreived must have the following format: tarFileName.gz. An exception is thrown if the Tar archive is not compressed."]}),"\n",(0,a.jsx)(r.h2,{id:"things-you-should-consider",children:"Things you should consider"}),"\n",(0,a.jsx)(r.p,{children:"The main questions you should ask yourself when adding items to a Tar archive are:"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Do you want to do more complex Tar operations? Use the ",(0,a.jsx)(r.code,{children:"FileSystem"}),"-based classes defined within the ",(0,a.jsx)(r.code,{children:"Xceed.Tar"})," namespace."]}),"\n"]})]})}function p(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},19365:(e,r,t)=>{t.d(r,{A:()=>i});t(96540);var a=t(34164);const n={tabItem:"tabItem_Ymn6"};var s=t(74848);function i(e){let{children:r,hidden:t,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(n.tabItem,i),hidden:t,children:r})}},11470:(e,r,t)=>{t.d(r,{A:()=>j});var a=t(96540),n=t(34164),s=t(23104),i=t(56347),l=t(205),o=t(57485),c=t(31682),u=t(70679);function d(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:r,children:t}=e;return(0,a.useMemo)((()=>{const e=r??function(e){return d(e).map((e=>{let{props:{value:r,label:t,attributes:a,default:n}}=e;return{value:r,label:t,attributes:a,default:n}}))}(t);return function(e){const r=(0,c.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function p(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function m(e){let{queryString:r=!1,groupId:t}=e;const n=(0,i.W6)(),s=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,o.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const r=new URLSearchParams(n.location.search);r.set(s,e),n.replace({...n.location,search:r.toString()})}),[s,n])]}function f(e){const{defaultValue:r,queryString:t=!1,groupId:n}=e,s=h(e),[i,o]=(0,a.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!p({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:r,tabValues:s}))),[c,d]=m({queryString:t,groupId:n}),[f,b]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[n,s]=(0,u.Dv)(t);return[n,(0,a.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:n}),g=(()=>{const e=c??f;return p({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{g&&o(g)}),[g]);return{selectedValue:i,selectValue:(0,a.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),b(e)}),[d,b,s]),tabValues:s}}var b=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function v(e){let{className:r,block:t,selectedValue:a,selectValue:i,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const r=e.currentTarget,t=o.indexOf(r),n=l[t].value;n!==a&&(c(r),i(n))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;r=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;r=o[t]??o[o.length-1];break}}r?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":t},r),children:l.map((e=>{let{value:r,label:t,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:a===r?0:-1,"aria-selected":a===r,ref:e=>o.push(e),onKeyDown:d,onClick:u,...s,className:(0,n.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":a===r}),children:t??r},r)}))})}function T(e){let{lazy:r,children:t,selectedValue:s}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=i.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:(0,n.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map(((e,r)=>(0,a.cloneElement)(e,{key:r,hidden:e.props.value!==s})))})}function y(e){const r=f(e);return(0,x.jsxs)("div",{className:(0,n.A)("tabs-container",g.tabList),children:[(0,x.jsx)(v,{...r,...e}),(0,x.jsx)(T,{...r,...e})]})}function j(e){const r=(0,b.A)();return(0,x.jsx)(y,{...e,children:d(e.children)},String(r))}},28453:(e,r,t)=>{t.d(r,{R:()=>i,x:()=>l});var a=t(96540);const n={},s=a.createContext(n);function i(e){const r=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),a.createElement(s.Provider,{value:r},e.children)}}}]);