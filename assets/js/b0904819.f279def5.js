"use strict";(self.webpackChunkxceed_libs_doc=self.webpackChunkxceed_libs_doc||[]).push([[6952],{58887:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>u,toc:()=>d});var t=i(74848),r=i(28453),s=i(11470),l=i(19365);const a={title:"Unzipping (QuickZip)"},o="Extracting files from a zip file (unzipping)",u={id:"code-snippets/unzipping/unzipping-quickzip",title:"Unzipping (QuickZip)",description:"This topic demonstrates how to unzip files using the static Unzip method of the QuickZip class.",source:"@site/zip/code-snippets/unzipping/unzipping-quickzip.md",sourceDirName:"code-snippets/unzipping",slug:"/code-snippets/unzipping/unzipping-quickzip",permalink:"/xceed-libs-doc/zip/code-snippets/unzipping/unzipping-quickzip",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Unzipping (QuickZip)"},sidebar:"sidebarzip",previous:{title:"Unzipping to memory",permalink:"/xceed-libs-doc/zip/code-snippets/unzipping/unzipping-to-memory"},next:{title:"Unzipping encrypted items that use 'compatible' encryption",permalink:"/xceed-libs-doc/zip/code-snippets/unzipping/unzipping-encrypted-itemsuse-compatible-encryption"}},c={},d=[{value:"Unzip method",id:"unzip-method",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Handling paths",id:"handling-paths",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Things you should consider",id:"things-you-should-consider",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"extracting-files-from-a-zip-file-unzipping",children:"Extracting files from a zip file (unzipping)"})}),"\n",(0,t.jsx)(n.p,{children:"This topic demonstrates how to unzip files using the static Unzip method of the QuickZip class."}),"\n",(0,t.jsxs)(n.p,{children:["When unzipping the contents of a spanned zip file, the ",(0,t.jsx)(n.strong,{children:"last"})," disk must be in the drive before the operation begins."]}),"\n",(0,t.jsx)(n.h2,{id:"unzip-method",children:"Unzip method"}),"\n",(0,t.jsx)(n.p,{children:"The Unzip method has various overloads that can be used to unzip files. Some only require that you specify the zip file and the files you want to extract while others let you decide on a number of other factors among which are the possibility to decrypt encrypted files and unzip files from split or spanned zip files."}),"\n",(0,t.jsx)(n.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,t.jsx)(n.p,{children:"In the following example, we will unzip the contents of a regular zip file:"}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(l.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'  using Xceed.Zip;\r\n  using Xceed.Zip.Sfx;\r\n\r\n  QuickZip.Unzip( @"d:\\test.zip", @"d:\\", true, true, false, "*" );\n'})})}),(0,t.jsx)(l.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-vb.NET",children:'  Imports Xceed.Zip\r\n  Imports Xceed.Sfx\r\n\r\n  QuickZip.Unzip( "d:\\test.zip", "d:\\", True, True, False, "*" )\n'})})})]}),"\n",(0,t.jsx)(n.p,{children:"In the next example, we will extract the contents of a spanned, self-extracting zip file:"}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(l.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'  using Xceed.Zip;\r\n  using Xceed.Zip.Sfx;\r\n  \r\n  QuickZip.Unzip( @"a:\\sfx.exe", @"d:\\", string.Empty, true, true, false, new QuickZip.DiskRequiredCallback( this.QuickDiskRequired ) ,null, "*" );\r\n  \r\n  // This method will handle the DiskRequired events that are raised when creating\r\n  // spanned or split zip files.\r\n  private bool QuickDiskRequired( string zipFile, int diskNumber, object userData )\r\n  {\r\n    if( MessageBox.Show( "Disk #" + diskNumber.ToString() + " is required.", "Disk Required", MessageBoxButtons.OKCancel ) == DialogResult.OK )\r\n        return true;\r\n    else\r\n        return false;    \r\n  }\n'})})}),(0,t.jsx)(l.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-vb.NET",children:'  Imports Xceed.Zip\r\n  Imports Xceed.Sfx\r\n\r\n  QuickZip.Unzip( "a:\\sfx.exe", "d:\\", string.Empty, true, true, false, New QuickZip.DiskRequiredCallback(AddressOf Me.QuickDiskRequired) ,Nothing, "*" )\r\n\r\n  \' This method will handle the DiskRequired events that are raised when creating\r\n  \' spanned or split zip files.\r\n  Private Function QuickDiskRequired(ByVal zipFile As String, ByVal diskNumber As Integer, ByVal userData As Object) As Boolean\r\n    If (MessageBox.Show("Disk #" + diskNumber.ToString() + " is required.", "Disk Required", MessageBoxButtons.OKCancel) = DialogResult.OK) Then\r\n      Return True\r\n    Else\r\n      Return False\r\n    End If\r\n  End Function\n'})})})]}),"\n",(0,t.jsx)(n.h2,{id:"handling-paths",children:"Handling paths"}),"\n",(0,t.jsx)(n.p,{children:"When extracting files from within a zip file, the directory structure can be restored fully or partrially or it can be omitted altogether."}),"\n",(0,t.jsxs)(n.p,{children:["If the preservePaths parameter of the Unzip method is set to ",(0,t.jsx)(n.strong,{children:"false"}),", the files specified in the filesToUnzip parameter will be restored directly into the root of the destination folder without recreating the directory structure."]}),"\n",(0,t.jsx)(n.p,{children:'For example, if you have a zip file containing files in the "folder1" subfolder and files in the "folder1\\folder2" subfolder, the following code will unzip all files right into "c:\\temp", without creating any subfolders:'}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(l.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'  Xceed.Zip.QuickZip.Unzip( @"c:\\test.zip", @"c:\\temp", true, true, false, @"folder1\\*" );\n'})})}),(0,t.jsx)(l.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-vb.NET",children:'  Xceed.Zip.QuickZip.Unzip( "c:\\test.zip", "c:\\temp", True, True, False, "folder1\\*" )\n'})})})]}),"\n",(0,t.jsxs)(n.p,{children:["If the preservePaths parameter is set to ",(0,t.jsx)(n.strong,{children:"true"}),", the part of the path that is explicitly included in the filesToUnzip parameter will not be restored into the destination folder."]}),"\n",(0,t.jsx)(n.p,{children:'For example, for the same zip file as above, the following code will create the folder "folder2" into the "c:\\temp" destination folder. Files that were in the "folder1" subfolder in the zip will be unzipped directly into the root of "c:\\temp", and files that were in "folder1\\folder2" will be unzipped into "c:\\temp\\folder2":'}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(l.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'  Xceed.Zip.QuickZip.Unzip( @"c:\\test.zip", @"c:\\temp", true, true, true, @"folder1\\*" );\n'})})}),(0,t.jsx)(l.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-vb.NET",children:'  Xceed.Zip.QuickZip.Unzip( "c:\\test.zip", "c:\\temp", True, True, True, "folder1\\*" )\n'})})})]}),"\n",(0,t.jsx)(n.p,{children:'The following example will unzip files into "c:\\temp\\folder1" and "c:\\temp\\folder1\\folder2":'}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(l.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'  Xceed.Zip.QuickZip.Unzip( @"c:\\test.zip", @"c:\\temp", true, true, true, @"*" );\n'})})}),(0,t.jsx)(l.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-vb.NET",children:'  Xceed.Zip.QuickZip.Unzip( "c:\\test.zip", "c:\\temp", True, True, True, "*" )\n'})})})]}),"\n",(0,t.jsx)(n.h2,{id:"remarks",children:"Remarks"}),"\n",(0,t.jsx)(n.p,{children:"Note that the filesToUntar parameter of the Untar method cannot be null; otherwise, an ArgumentNullException exception will be thrown."}),"\n",(0,t.jsx)(n.h2,{id:"things-you-should-consider",children:"Things you should consider"}),"\n",(0,t.jsx)(n.p,{children:"The main questions you should ask yourself when extracting files from a Tar archive are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Do you want to do more complex Tar archive operations? Use the FileSystem-based classes defined within the ",(0,t.jsx)(n.code,{children:"Xceed.Tar"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},19365:(e,n,i)=>{i.d(n,{A:()=>l});i(96540);var t=i(34164);const r={tabItem:"tabItem_Ymn6"};var s=i(74848);function l(e){let{children:n,hidden:i,className:l}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,t.A)(r.tabItem,l),hidden:i,children:n})}},11470:(e,n,i)=>{i.d(n,{A:()=>k});var t=i(96540),r=i(34164),s=i(23104),l=i(56347),a=i(205),o=i(57485),u=i(31682),c=i(70679);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:i}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:i,attributes:t,default:r}}=e;return{value:n,label:i,attributes:t,default:r}}))}(i);return function(e){const n=(0,u.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function h(e){let{value:n,tabValues:i}=e;return i.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:i}=e;const r=(0,l.W6)(),s=function(e){let{queryString:n=!1,groupId:i}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return i??null}({queryString:n,groupId:i});return[(0,o.aZ)(s),(0,t.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(r.location.search);n.set(s,e),r.replace({...r.location,search:n.toString()})}),[s,r])]}function m(e){const{defaultValue:n,queryString:i=!1,groupId:r}=e,s=p(e),[l,o]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:i}=e;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:i}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${i.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=i.find((e=>e.default))??i[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s}))),[u,d]=f({queryString:i,groupId:r}),[m,g]=function(e){let{groupId:n}=e;const i=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,s]=(0,c.Dv)(i);return[r,(0,t.useCallback)((e=>{i&&s.set(e)}),[i,s])]}({groupId:r}),b=(()=>{const e=u??m;return h({value:e,tabValues:s})?e:null})();(0,a.A)((()=>{b&&o(b)}),[b]);return{selectedValue:l,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),g(e)}),[d,g,s]),tabValues:s}}var g=i(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=i(74848);function v(e){let{className:n,block:i,selectedValue:t,selectValue:l,tabValues:a}=e;const o=[],{blockElementScrollPositionUntilNextRender:u}=(0,s.a_)(),c=e=>{const n=e.currentTarget,i=o.indexOf(n),r=a[i].value;r!==t&&(u(n),l(r))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const i=o.indexOf(e.currentTarget)+1;n=o[i]??o[0];break}case"ArrowLeft":{const i=o.indexOf(e.currentTarget)-1;n=o[i]??o[o.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":i},n),children:a.map((e=>{let{value:n,label:i,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>o.push(e),onKeyDown:d,onClick:c,...s,className:(0,r.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":t===n}),children:i??n},n)}))})}function z(e){let{lazy:n,children:i,selectedValue:s}=e;const l=(Array.isArray(i)?i:[i]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===s));return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function j(e){const n=m(e);return(0,x.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,x.jsx)(v,{...n,...e}),(0,x.jsx)(z,{...n,...e})]})}function k(e){const n=(0,g.A)();return(0,x.jsx)(j,{...e,children:d(e.children)},String(n))}},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(96540);const r={},s=t.createContext(r);function l(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);