"use strict";(self.webpackChunkxceed_libs_doc=self.webpackChunkxceed_libs_doc||[]).push([[2360],{44016:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=t(74848),n=t(28453),i=t(11470),a=t(19365);const o={},l="ReparsePointTagsFilter class",c={id:"basic-concepts/filters/reparse-point-tags-filter-class",title:"ReparsePointTagsFilter class",description:"The ReparsePointTagsFilter class can be used to filter files and folders according to their ReparsePointTags value.",source:"@site/ftp/basic-concepts/filters/reparse-point-tags-filter-class.md",sourceDirName:"basic-concepts/filters",slug:"/basic-concepts/filters/reparse-point-tags-filter-class",permalink:"/xceed-libs-doc/ftp/basic-concepts/filters/reparse-point-tags-filter-class",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarftp",previous:{title:"OrFilter",permalink:"/xceed-libs-doc/ftp/basic-concepts/filters/orfilter-class"},next:{title:"QuickFtp class",permalink:"/xceed-libs-doc/ftp/basic-concepts/quick-ftp-class"}},u={},d=[{value:"Background",id:"background",level:2},{value:"WindowsDiskFile/WindowsDiskFolder needed to access reparse point tags",id:"windowsdiskfilewindowsdiskfolder-needed-to-access-reparse-point-tags",level:2},{value:"Prevent recursing into directories that are name surrogates",id:"prevent-recursing-into-directories-that-are-name-surrogates",level:2}];function p(e){const r={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"reparsepointtagsfilter-class",children:"ReparsePointTagsFilter class"})}),"\n",(0,s.jsxs)(r.p,{children:["The ",(0,s.jsx)(r.code,{children:"ReparsePointTagsFilter"})," class can be used to filter files and folders according to their ReparsePointTags value."]}),"\n",(0,s.jsx)(r.h2,{id:"background",children:"Background"}),"\n",(0,s.jsx)(r.p,{children:"Hard disks sometimes contain special files and folders that link to other files, folder and, sometimes, other volumes. These are known as symbolic links, hard links, directory junctions, volume mount points, depending on the literature and the version of Windows."}),"\n",(0,s.jsxs)(r.p,{children:["The term reparse point is used in Microsoft documentation to designate the special attribute that identify any kind of link or other special property of a file or item. A reparse point is a bit in the ",(0,s.jsx)(r.code,{children:"System.IO.FileAttributes"})," enumeration."]}),"\n",(0,s.jsx)(r.p,{children:"Reparse point tags are a supplemental integer value that specify what specific type of reparse point a file or folder is."}),"\n",(0,s.jsx)(r.p,{children:"So a file or folder that is a reparse point will have the ReparsePoint bit set in its Attributes and, possibly, have an associated reparse point tag value."}),"\n",(0,s.jsx)(r.p,{children:"In practice, symbolic links, hard links, directory junctions, volume mount points are all links of some kind. Microsoft has a name for these special items. They are called name surrogates. They are identified by the Windows API macro IsReparseTagNameSurrogate()."}),"\n",(0,s.jsx)(r.p,{children:"By default, the .NET framework and Xceed Zip for .NET automatically follows any link it encounters during scanning and zipping transparently."}),"\n",(0,s.jsx)(r.p,{children:"In some situations, transparently following links might not be the desired action. In these cases, this filter provides options to control whether a link is followed or not."}),"\n",(0,s.jsx)(r.h2,{id:"windowsdiskfilewindowsdiskfolder-needed-to-access-reparse-point-tags",children:"WindowsDiskFile/WindowsDiskFolder needed to access reparse point tags"}),"\n",(0,s.jsxs)(r.p,{children:["The .NET framework does not detect reparse points tags. It detects reparse points in general and sets the ReparsePoint bit set in the ",(0,s.jsx)(r.code,{children:"Attributes"})," property."]}),"\n",(0,s.jsx)(r.p,{children:"While this can be a sufficient filtering criteria, it must be understood that not all reparse points are symbolic links and alike. Microsoft does not explain in detail what the other types are (you can view the names here) but it's possible an application will encounter them."}),"\n",(0,s.jsx)(r.p,{children:"The WindowsDiskFile/WindowsDiskFolder classes access the Windows file system directly to perform operations. Therefore they can gain access to the reparse point tag information, allowing the ReparsePointTags filter to work to its full potential."}),"\n",(0,s.jsx)(r.p,{children:"It is possible to use ReparsePointTags on any AbstractFile and AbstractFolder, but the reparse point tag value will always be 0."}),"\n",(0,s.jsx)(r.h2,{id:"prevent-recursing-into-directories-that-are-name-surrogates",children:"Prevent recursing into directories that are name surrogates"}),"\n",(0,s.jsxs)(r.p,{children:["This example processes all the files that have the TXT ",(0,s.jsx)(r.strong,{children:"or"})," the EXE extension."]}),"\n",(0,s.jsxs)(i.A,{children:[(0,s.jsx)(a.A,{value:"csharp",label:"C#",default:!0,children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-csharp",children:'  AbstractFile zipFile = new DiskFile( "ReparsePointTagsFilterExample.zip" );\r\n\r\n  if( zipFile.Exists )\r\n    zipFile.Delete();\r\n\r\n  ZipArchive zip = new ZipArchive( zipFile );\r\n\r\n  /* Notice how we use WindowsDiskFolder here. WindowsDiskFile/WindowsDiskFolder classes\r\n  are able to obtain the reparse point tag values from Windows. Unlike DiskFile/DiskFolder. */\r\n        \r\n  // Select a source folder\r\n  AbstractFolder sourceFolder = new WindowsDiskFolder( @"C:\\Users" );\r\n\r\n  /* The default behavior of the ReparsePointTagsFilter is to exclude reparse\r\n  point name surrogate files and folders when recursing into subfolders */\r\n\r\n  // Create a reparse point filter\r\n  Filter filters = new ReparsePointTagsFilter();\r\n\r\n  /* Using the filter when zipping will exclude name surrogate files and folders */\r\n\r\n  // Apply the reparse point filter when zipping\r\n  sourceFolder.CopyFilesTo( zip, true, true, filters );\n'})})}),(0,s.jsx)(a.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-vb.NET",children:"  Dim zipFile As AbstractFile = New DiskFile(\"ReparsePointTagsFilterExample.zip\")\r\n\r\n  If zipFile.Exists Then\r\n    zipFile.Delete()\r\n  End If\r\n\r\n  Dim zip As New ZipArchive(zipFile)\r\n\r\n'       Notice how we use WindowsDiskFolder here. WindowsDiskFile/WindowsDiskFolder classes\r\n'      are able to obtain the reparse point tag values from Windows. Unlike DiskFile/DiskFolder. \r\n\r\n  ' Select a source folder\r\n  Dim sourceFolder As AbstractFolder = New WindowsDiskFolder(\"C:\\Users\")\r\n\r\n'       The default behavior of the ReparsePointTagsFilter is to exclude reparse\r\n'      point name surrogate files and folders when recursing into subfolders \r\n\r\n  ' Create a reparse point filter\r\n  Dim filters As Filter = New ReparsePointTagsFilter()\r\n\r\n  ' Using the filter when zipping will exclude name surrogate files and folders \r\n\r\n  ' Apply the reparse point filter when zipping\r\n  sourceFolder.CopyFilesTo(zip, True, True, filters)\n"})})})]})]})}function h(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},19365:(e,r,t)=>{t.d(r,{A:()=>a});t(96540);var s=t(34164);const n={tabItem:"tabItem_Ymn6"};var i=t(74848);function a(e){let{children:r,hidden:t,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,s.A)(n.tabItem,a),hidden:t,children:r})}},11470:(e,r,t)=>{t.d(r,{A:()=>y});var s=t(96540),n=t(34164),i=t(23104),a=t(56347),o=t(205),l=t(57485),c=t(31682),u=t(70679);function d(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:r}=e;return!!r&&"object"==typeof r&&"value"in r}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:r,children:t}=e;return(0,s.useMemo)((()=>{const e=r??function(e){return d(e).map((e=>{let{props:{value:r,label:t,attributes:s,default:n}}=e;return{value:r,label:t,attributes:s,default:n}}))}(t);return function(e){const r=(0,c.XI)(e,((e,r)=>e.value===r.value));if(r.length>0)throw new Error(`Docusaurus error: Duplicate values "${r.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[r,t])}function h(e){let{value:r,tabValues:t}=e;return t.some((e=>e.value===r))}function f(e){let{queryString:r=!1,groupId:t}=e;const n=(0,a.W6)(),i=function(e){let{queryString:r=!1,groupId:t}=e;if("string"==typeof r)return r;if(!1===r)return null;if(!0===r&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:r,groupId:t});return[(0,l.aZ)(i),(0,s.useCallback)((e=>{if(!i)return;const r=new URLSearchParams(n.location.search);r.set(i,e),n.replace({...n.location,search:r.toString()})}),[i,n])]}function b(e){const{defaultValue:r,queryString:t=!1,groupId:n}=e,i=p(e),[a,l]=(0,s.useState)((()=>function(e){let{defaultValue:r,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(r){if(!h({value:r,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${r}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return r}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:r,tabValues:i}))),[c,d]=f({queryString:t,groupId:n}),[b,m]=function(e){let{groupId:r}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(r),[n,i]=(0,u.Dv)(t);return[n,(0,s.useCallback)((e=>{t&&i.set(e)}),[t,i])]}({groupId:n}),g=(()=>{const e=c??b;return h({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{g&&l(g)}),[g]);return{selectedValue:a,selectValue:(0,s.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),m(e)}),[d,m,i]),tabValues:i}}var m=t(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var w=t(74848);function v(e){let{className:r,block:t,selectedValue:s,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),u=e=>{const r=e.currentTarget,t=l.indexOf(r),n=o[t].value;n!==s&&(c(r),a(n))},d=e=>{let r=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;r=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;r=l[t]??l[l.length-1];break}}r?.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":t},r),children:o.map((e=>{let{value:r,label:t,attributes:i}=e;return(0,w.jsx)("li",{role:"tab",tabIndex:s===r?0:-1,"aria-selected":s===r,ref:e=>l.push(e),onKeyDown:d,onClick:u,...i,className:(0,n.A)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":s===r}),children:t??r},r)}))})}function k(e){let{lazy:r,children:t,selectedValue:i}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(r){const e=a.find((e=>e.props.value===i));return e?(0,s.cloneElement)(e,{className:(0,n.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:a.map(((e,r)=>(0,s.cloneElement)(e,{key:r,hidden:e.props.value!==i})))})}function x(e){const r=b(e);return(0,w.jsxs)("div",{className:(0,n.A)("tabs-container",g.tabList),children:[(0,w.jsx)(v,{...r,...e}),(0,w.jsx)(k,{...r,...e})]})}function y(e){const r=(0,m.A)();return(0,w.jsx)(x,{...e,children:d(e.children)},String(r))}},28453:(e,r,t)=>{t.d(r,{R:()=>a,x:()=>o});var s=t(96540);const n={},i=s.createContext(n);function a(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);