"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[2718],{47104:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>u,contentTitle:()=>n,default:()=>k,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var s=o(74848),t=o(28453);const l={},n="Calculate Worksheet formulas",a={id:"code-snippets/worksheet/calculate-worksheet-formulas",title:"Calculate Worksheet formulas",description:"This example demonstrates how to calculate Worksheet formulas when using the API from the Xceed Workbooks for .NET.",source:"@site/workbooks/code-snippets/worksheet/calculate-worksheet-formulas.md",sourceDirName:"code-snippets/worksheet",slug:"/code-snippets/worksheet/calculate-worksheet-formulas",permalink:"/xceed-libs-doc/workbooks/code-snippets/worksheet/calculate-worksheet-formulas",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarsworkbooks",previous:{title:"Cell, Row, Column access",permalink:"/xceed-libs-doc/workbooks/code-snippets/worksheet/cell-row-column-access"},next:{title:"Insert or Delete rows",permalink:"/xceed-libs-doc/workbooks/code-snippets/worksheet/insert-delete-rows"}},u={},c=[];function h(e){const r={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"calculate-worksheet-formulas",children:"Calculate Worksheet formulas"})}),"\n",(0,s.jsx)(r.p,{children:"This example demonstrates how to calculate Worksheet formulas when using the API from the Xceed Workbooks for .NET."}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-csharp",children:'        public static void CalculateWorksheetFormulas()\r\n    {\r\n      using( var workbook = Workbook.Create( "CalculateWorksheetFormulas.xlsx" ) )\r\n      {\r\n        // Get the first worksheet. A workbook contains at least 1 worksheet.\r\n        var worksheet = workbook.Worksheets[ 0 ];\r\n\r\n        // Add a title.\r\n        worksheet.Cells[ "B1" ].Value = "Calculate Worksheet Formulas";\r\n        worksheet.Cells[ "B1" ].Style.Font = new Font() { Bold = true, Size = 15.5d };\r\n\r\n        // Fill cells values in WorksheetA.\r\n        worksheet.Cells[ "A5" ].Value = "Employees";\r\n        worksheet.Cells[ "B5" ].Value = "Salary";\r\n        worksheet.Cells[ "A6" ].Value = "Mike Jones";\r\n        worksheet.Cells[ "B6" ].Value = 52000;\r\n        worksheet.Cells[ "A7" ].Value = "Cathy Smith";\r\n        worksheet.Cells[ "B7" ].Value = 46000;\r\n        worksheet.Cells[ "A8" ].Value = "Kevin Malcolm";\r\n        worksheet.Cells[ "B8" ].Value = 77000;\r\n        worksheet.Cells[ "A9" ].Value = "Jenny McIntyre";\r\n        worksheet.Cells[ "B9" ].Value = 61000;\r\n        worksheet.Cells[ "A10" ].Value = "AVERAGE:";\r\n\r\n        // AutoFit first column in WorksheetA.\r\n        worksheet.Columns[ "A" ].AutoFit();\r\n\r\n        // Set second column\'s format in WorksheetA.\r\n        worksheet.Columns[ "B" ].Style.CustomFormat = "$#,###";\r\n\r\n        // Set rows styles for 5th and 10th rows.\r\n        worksheet.Rows[ 4 ].Style.Font.Bold = true;\r\n        worksheet.Rows[ 9 ].Style.Font.Bold = true;\r\n\r\n        // Set average employees salary formula in Worksheet.\r\n        worksheet.Cells[ "B10" ].Formula = "=AVERAGE(B6:B9)";\r\n\r\n        // Cells with formula do not set their Value property until opened with MS Excel or CalculateFormulas() is called.\r\n        var worksheet_averageValue = worksheet.Cells[ "B10" ].Value;\r\n        Debug.Assert( worksheet_averageValue == null );\r\n\r\n        // Calculate formulas for this worksheet.\r\n        worksheet.CalculateFormulas();\r\n\r\n        // Cells with formula now have a calculated value.\r\n        worksheet_averageValue = worksheet.Cells[ "B10" ].Value;\r\n        Debug.Assert( worksheet_averageValue != null );\r\n\r\n        // Display calculation results in other cells.\r\n        worksheet.Cells[ "C15" ].Value = "Result of formula calculation for Sheet1 in B10 is:  " + worksheet_averageValue;\r\n\r\n        // Save workbook to disk.\r\n        workbook.Save();\r\n        Console.WriteLine( "\\tCreated: CalculateWorksheetFormulas.xlsx\\n" );\r\n      }\r\n    }\r\n\n'})})]})}function k(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,r,o)=>{o.d(r,{R:()=>n,x:()=>a});var s=o(96540);const t={},l=s.createContext(t);function n(e){const r=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:n(e.components),s.createElement(l.Provider,{value:r},e.children)}}}]);