"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[6085],{64563:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>u});var r=n(74848),a=n(28453),i=n(11470),s=n(19365);const o={},l="Using alternative AES implementations",c={id:"advanced-concepts/using-alternative-aes-implementations",title:"Using alternative AES implementations",description:"The WinZip AES encryption method is implemented using a core AES encryption algorithm implementation provided by the .NET framework, along with data formatting that follows a specification first introduced by the WinZip company, hence the name WinZip AES.",source:"@site/zip/advanced-concepts/using-alternative-aes-implementations.md",sourceDirName:"advanced-concepts",slug:"/advanced-concepts/using-alternative-aes-implementations",permalink:"/xceed-docs-words/zip/advanced-concepts/using-alternative-aes-implementations",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarzip",previous:{title:"Retrieving a CompressedStream's remaining data",permalink:"/xceed-docs-words/zip/advanced-concepts/retrieving-compressedstream"},next:{title:"Code Snippets",permalink:"/xceed-docs-words/zip/category/code-snippets"}},d={},u=[];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"using-alternative-aes-implementations",children:"Using alternative AES implementations"})}),"\n",(0,r.jsx)(t.p,{children:"The WinZip AES encryption method is implemented using a core AES encryption algorithm implementation provided by the .NET framework, along with data formatting that follows a specification first introduced by the WinZip company, hence the name WinZip AES."}),"\n",(0,r.jsx)(t.p,{children:"Several implementations of the AES encryption algorithm have been added to the .NET framework, all based on the System.Security.Cryptography.SymmetricAlgorithm abstract class."}),"\n",(0,r.jsx)(t.p,{children:"By default, Xceed Zip for .NET uses the System.Security.Cryptography.RijndaelManaged class. But other implementations are available and can be used by the developer. All implementations will perform the same task and provide the same result. The only difference might be speed in some very specific scenarios."}),"\n",(0,r.jsx)(t.p,{children:"In most if not all cases, RijndaelManaged is adequate. Our tests have shown that with the average modern CPU, the default RijndaelManaged is as fast as the other implementations. It is therefore recommended that applications should use the default implementation unless they have a very specific speed requirement, as well as very limited installation needs, as the alternative AES implementations require specific versions of Windows."}),"\n",(0,r.jsxs)(t.admonition,{type:"note",children:[(0,r.jsx)(t.p,{children:"Xceed does not provide support for problems that occur when the AesAlgorithmManager property (see below) is used."}),(0,r.jsx)(t.p,{children:"Alternative AES implementations are not supported by the Compact Framework versions of Xceed Zip for .NET and Xceed Real-Time Zip, nor by Xceed Real-Time Zip for Silverilght."})]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Class Name"}),(0,r.jsx)(t.th,{children:"Minimum Requirements"}),(0,r.jsx)(t.th,{children:"Notes"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"System.Security.Cryptography.RijndaelManaged"}),(0,r.jsx)(t.td,{children:".NET Framework 2.0 and up."}),(0,r.jsx)(t.td,{children:"Works in all .NET framework versions. Always safe to use. Adequate speed. Does not require special privileges. Used by Xceed Zip for .NET by default."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"System.Security.Cryptography.AesManaged"}),(0,r.jsx)(t.td,{children:".NET Framework 3.5 and up. Windows XP SP2 and later."}),(0,r.jsx)(t.td,{children:"May be faster than RijndaelManaged. Won't work if the Windows security policy setting for Federal Information Processing Standards (FIPS)-compliant algorithms is enabled on the target machine. Has HostProtection attribute set to MayLeakOnAbort."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"System.Security.Cryptography.AesCryptoServiceProvider"}),(0,r.jsx)(t.td,{children:".NET Framework 3.5 and up. Windows XP SP2 and later."}),(0,r.jsx)(t.td,{children:"Uses Cryptographic Application Programming Interfaces (CAPI) of Windows as implementation. May be faster than RijndaelManaged. Has HostProtection attribute set to MayLeakOnAbort."})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"AesCng"}),(0,r.jsx)(t.td,{children:"Windows Vista and later."}),(0,r.jsxs)(t.td,{children:['Uses Windows Cryptography API: Next Generation (CNG) as implementation. Not part of the .NET framework. Requires a custom implementation of SymmetricAlgorithm that will call Windows. See the "CLR Security" project at ',(0,r.jsx)(t.a,{href:"http://clrsecurity.codeplex.com/",children:"http://clrsecurity.codeplex.com/"})," for an example implementation. May be faster than RijndaelManaged, especially on new CPUs that implement Intel\xae Advanced Encryption Standard Instructions (AES-NI)."]})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"To use an alternative AES implementation with Xceed Zip for .NET, you must create a class that implements the Xceed.Zip.IAesAlgorithmManager interface. An instance of that class must then be set to the ZipArchive.AesAlgorithmManager property, or to the ZipWriter.AesAlgorithmManager or ZipReader.AesAlgorithmManager."}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"This design was chosen so that the Xceed components never directly reference classes that are not part of at least .NET 2.0 or require specific versions of Windows."})}),"\n",(0,r.jsx)(t.p,{children:"The Xceed.Zip.IAesAlgorithmManager interface exists only to allow the component to create instances of the SymmetricAlgorithm class as needed. The following example shows how an implementation of IAesAlgorithmManager would use .NET's AesCryptoServiceProvider."}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(s.A,{value:"csharp",label:"C#",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:"  public class AesManagedManager : IAesAlgorithmManager\r\n  {\r\n    public SymmetricAlgorithm CreateAesAlgorithm()\r\n    {\r\n      return new System.Security.Cryptography.AesCryptoServiceProvider();\r\n    }\r\n  }\n"})})}),(0,r.jsx)(s.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-vb.NET",children:"  Public Class AesManagedManager\r\n    Implements IAesAlgorithmManager\r\n    Public Function CreateAesAlgorithm() As SymmetricAlgorithm\r\n      Return New System.Security.Cryptography.AesCryptoServiceProvider()\r\n    End Function\r\n  End Class\n"})})})]}),"\n",(0,r.jsx)(t.p,{children:"Using a custom implementation of SymmetricAlgorithm is just as simple. The next example uses the implementation from the \"CLR Security\" project. After adding the project's Security.Cryptography.dll to your application's references, the IAesAlgorithmManager implementation would be as follows:"}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(s.A,{value:"csharp",label:"C#",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:"public class AesCngManager : IAesAlgorithmManager\r\n{\r\n  public SymmetricAlgorithm CreateAesAlgorithm()\r\n  {\r\n    return new Security.Cryptography.AesCng();\r\n  }\r\n}\n"})})}),(0,r.jsx)(s.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-vb.NET",children:"Public Class AesCngManager\r\nImplements IAesAlgorithmManager\r\nPublic Function CreateAesAlgorithm() As SymmetricAlgorithm\r\nReturn New Security.Cryptography.AesCng()\r\nEnd Function\r\nEnd Class\n"})})})]}),"\n",(0,r.jsx)(t.p,{children:"Then, an instance of your class is given to the component for use when zipping/unzipping circumstances require it:"}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(s.A,{value:"csharp",label:"C#",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:"IAesAlgorithmManager aesManager = new AesManagedManager();\r\nZipArchive.AesAlgorithmManager = aesManager;\r\nZipReader.AesAlgorithmManager = aesManager;\r\nZipWriter.AesAlgorithmManager = aesManager;\n"})})}),(0,r.jsx)(s.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-vb.NET",children:"Dim aesManager As IAesAlgorithmManager = New AesManagedManager()\r\nZipArchive.AesAlgorithmManager = aesManager\r\nZipReader.AesAlgorithmManager = aesManager\r\nZipWriter.AesAlgorithmManager = aesManager\n"})})})]}),"\n",(0,r.jsx)(t.p,{children:"Setting the value of AesAlgorithmManager to null (Nothing in Visual Basic), the default value, causes the component to use the RijndaelManaged implementation of AES."}),"\n",(0,r.jsxs)(t.admonition,{type:"warning",children:[(0,r.jsx)(t.p,{children:"The SymmetricAlgorithm instance that IAesAlgorithmManager produces must implement the AES algorithm correctly. The component has no way to check this. Faulty implementations will produce corrupted zip files and undefined behavior in your application."}),(0,r.jsx)(t.p,{children:"The SymmetricAlgorithm instance that IAesAlgorithmManager produces must allow the SymmetricAlgorithm.BlockSize property to be set to 128, the SymmetricAlgorithm.Mode property to be set to CipherMode.ECB, and the SymmetricAlgorithm.CreateEncryptor() method to be called successfully. Failure to meet these requirements will produce corrupted zip files and undefined behavior in your application."})]}),"\n",(0,r.jsxs)(t.p,{children:["The component will call ",(0,r.jsx)(t.strong,{children:"Dispose"})," on the SymmetricAlgorithm instance when it is no longer needed. This includes error conditions."]})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>s});n(96540);var r=n(34164);const a={tabItem:"tabItem_Ymn6"};var i=n(74848);function s(e){let{children:t,hidden:n,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,s),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>j});var r=n(96540),a=n(34164),i=n(23104),s=n(56347),o=n(205),l=n(57485),c=n(31682),d=n(70679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=h(e),[s,l]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[c,u]=m({queryString:n,groupId:a}),[g,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,d.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),y=(()=>{const e=c??g;return p({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{y&&l(y)}),[y]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,i]),tabValues:i}}var f=n(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var A=n(74848);function b(e){let{className:t,block:n,selectedValue:r,selectValue:s,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),d=e=>{const t=e.currentTarget,n=l.indexOf(t),a=o[n].value;a!==r&&(c(t),s(a))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,A.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,A.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>l.push(e),onKeyDown:u,onClick:d,...i,className:(0,a.A)("tabs__item",y.tabItem,i?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:i}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,A.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function x(e){const t=g(e);return(0,A.jsxs)("div",{className:(0,a.A)("tabs-container",y.tabList),children:[(0,A.jsx)(b,{...t,...e}),(0,A.jsx)(v,{...t,...e})]})}function j(e){const t=(0,f.A)();return(0,A.jsx)(x,{...e,children:u(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var r=n(96540);const a={},i=r.createContext(a);function s(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);