"use strict";(self.webpackChunkxceed_libs_doc=self.webpackChunkxceed_libs_doc||[]).push([[5113],{22483:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>u,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var t=n(74848),r=n(28453),s=n(11470),a=n(19365);const l={title:"Zipping (QuickZip)"},o="Adding files to a zip file (zipping)",c={id:"code-snippets/zipping/zipping-quickzip",title:"Zipping (QuickZip)",description:"This topic demonstrates how to add files to a zip file using the static Zip method of the QuickZip class.",source:"@site/zip/code-snippets/zipping/zipping-quickzip.md",sourceDirName:"code-snippets/zipping",slug:"/code-snippets/zipping/zipping-quickzip",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/zipping-quickzip",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Zipping (QuickZip)"},sidebar:"sidebarzip",previous:{title:"Zipping items in memory",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/zipping-located-in-memory"},next:{title:"Reading and writing nested Zip archives",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/reading-writing-nested-zip"}},u={},d=[{value:"Zip method",id:"zip-method",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Things you should consider",id:"things-you-should-consider",level:2}];function p(e){const i={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"adding-files-to-a-zip-file-zipping",children:"Adding files to a zip file (zipping)"})}),"\n",(0,t.jsxs)(i.p,{children:["This topic demonstrates how to add files to a zip file using the static ",(0,t.jsx)(i.code,{children:"Zip"})," method of the ",(0,t.jsx)(i.code,{children:"QuickZip"})," class."]}),"\n",(0,t.jsx)(i.h2,{id:"zip-method",children:"Zip method"}),"\n",(0,t.jsx)(i.p,{children:"The Zip method has various overloads that can be used to zip files. Some only require that you specify the zip file and the files you want to add to the zip file while others let you decide on a number of other factors among which are the possibility to encrypt the files that are added to the zip file, create self-extracting zip files and create spanned or split zip files."}),"\n",(0,t.jsx)(i.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,t.jsx)(i.p,{children:"In the following example, we will create a regular zip file:"}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(a.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:'  using Xceed.Zip;\r\n  QuickZip.Zip( @"d:\\test.zip", true, true, false, @"d:\\file.txt" );\n'})})}),(0,t.jsx)(a.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-vb.NET",children:'    Imports Xceed.Zip\r\n    QuickZip.Zip( "d:\\test.zip", True, True, False, "d:\\file.txt" )\n'})})})]}),"\n",(0,t.jsx)(i.p,{children:"In the next example, we will create a spanned, self-extracting zip file:"}),"\n",(0,t.jsxs)(s.A,{children:[(0,t.jsx)(a.A,{value:"csharp",label:"C#",default:!0,children:(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-csharp",children:'    using Xceed.Zip;\r\n    using Xceed.Zip.Sfx;\r\n    using Xceed.FileSystem;\r\n\r\n    // Note: Pathnames must be modified for code snippets to work under the .NET Compact Framework.\r\n\r\n    XceedSfxPrefix sfx = new XceedSfxPrefix( new DiskFile( @"C:\\Program Files\\Xceed Components\\Bin\\Sfx\\xcdsfx32.bin" ) );\r\n\r\n    sfx.DialogStrings[ DialogStrings.Title ] = "Welcome to Xceed Zip for .NET!";\r\n    sfx.DefaultDestinationFolder = @"C:\\";sfx.ExistingFileBehavior = ExistingFileBehavior.OverwriteOlderOnly;\r\n\r\n    QuickZip.Zip( @"a:\\sfx.exe", string.Empty, true, true, false,\r\n                  sfx, new QuickZip.DiskRequiredCallback( this.QuickDiskRequired ),\r\n                  null, @"d:\\file.txt" );\r\n\r\n    // This method will handle the DiskRequired events that are raised when creating\r\n    // spanned or split zip files.\r\n    private bool QuickDiskRequired( string zipFile, int diskNumber, object userData )\r\n    {\r\n      if( MessageBox.Show( "Disk #" + diskNumber.ToString() + " is required.",\r\n                            "Disk Required", MessageBoxButtons.OKCancel ) == DialogResult.OK )\r\n          return true;\r\n      else\r\n          return false;    \r\n    }\n'})})}),(0,t.jsx)(a.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-vb.NET",children:'    Imports Xceed.Zip\r\n    Imports Xceed.Zip.Sfx\r\n    Imports Xceed.FileSystem\r\n\r\n    \' Note: Pathnames must be modified for code snippets to work under the .NET Compact Framework.\r\n\r\n    Dim sfx As New XceedSfxPrefix(New DiskFile("C:\\Program Files\\Xceed Components\\Bin\\Sfx\\xcdsfx32.bin"))\r\n\r\n    sfx.DialogStrings(DialogStrings.Title) = "Welcome to Xceed Zip for .NET!"\r\n    sfx.DefaultDestinationFolder = "C:\\"sfx.ExistingFileBehavior = ExistingFileBehavior.OverwriteOlderOnly\r\n\r\n    QuickZip.Zip("a:\\sfx.exe", String.Empty, True, True, False, sfx, _\r\n                New QuickZip.DiskRequiredCallback(AddressOf Me.QuickDiskRequired), _\r\n                Nothing, "d:\\file.txt")\r\n\r\n    \' This method will handle the DiskRequired events that are raised when creating\r\n    \' spanned or split zip files.\r\n\r\n    Private Function QuickDiskRequired(ByVal zipFile As String, _\r\n                                      ByVal diskNumber As Integer, _\r\n                                      ByVal userData As Object) As Boolean\r\n\r\n      If (MessageBox.Show("Disk #" + diskNumber.ToString() + " is required.", _\r\n                          "Disk Required", MessageBoxButtons.OKCancel) = DialogResult.OK) Then\r\n          Return True\r\n      Else\r\n          Return False\r\n      End If\r\n    End Function\n'})})})]}),"\n",(0,t.jsx)(i.h2,{id:"remarks",children:"Remarks"}),"\n",(0,t.jsxs)(i.p,{children:['When recursively adding files to a zip file, you have to consider every filename you place in the filesToZip parameter as a filemask. For example, if you set the filesToZip parameter to "c:\\file.txt", the ',(0,t.jsx)(i.strong,{children:"entire"}),' "c:" drive will be scanned and all the files that are named "file.txt" that are found will be included in the zip file.']}),"\n",(0,t.jsxs)(i.p,{children:["Note that the ",(0,t.jsx)(i.em,{children:"filesToZip"})," parameter of the Zip method cannot be null otherwise an ",(0,t.jsx)(i.code,{children:"ArgumentNullException"})," exception will be thrown."]}),"\n",(0,t.jsx)(i.h2,{id:"things-you-should-consider",children:"Things you should consider"}),"\n",(0,t.jsx)(i.p,{children:"The main questions you should ask yourself when copying items to a zip file are:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Do you want to do more complex zip file operations? Use the other classes defined within the ",(0,t.jsx)(i.code,{children:"Xceed.Zip namespace"}),"."]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsxs)(i.strong,{children:["All zip files will automatically be created in the ",(0,t.jsx)(i.a,{href:"/zip/basic-concepts/zip64-zip-file-format",children:"Zip64 zip file format"})," if the limitations of the regular Zip format are reached."]})})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},19365:(e,i,n)=>{n.d(i,{A:()=>a});n(96540);var t=n(34164);const r={tabItem:"tabItem_Ymn6"};var s=n(74848);function a(e){let{children:i,hidden:n,className:a}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,t.A)(r.tabItem,a),hidden:n,children:i})}},11470:(e,i,n)=>{n.d(i,{A:()=>y});var t=n(96540),r=n(34164),s=n(23104),a=n(56347),l=n(205),o=n(57485),c=n(31682),u=n(70679);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:i}=e;return!!i&&"object"==typeof i&&"value"in i}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:i,children:n}=e;return(0,t.useMemo)((()=>{const e=i??function(e){return d(e).map((e=>{let{props:{value:i,label:n,attributes:t,default:r}}=e;return{value:i,label:n,attributes:t,default:r}}))}(n);return function(e){const i=(0,c.XI)(e,((e,i)=>e.value===i.value));if(i.length>0)throw new Error(`Docusaurus error: Duplicate values "${i.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[i,n])}function h(e){let{value:i,tabValues:n}=e;return n.some((e=>e.value===i))}function f(e){let{queryString:i=!1,groupId:n}=e;const r=(0,a.W6)(),s=function(e){let{queryString:i=!1,groupId:n}=e;if("string"==typeof i)return i;if(!1===i)return null;if(!0===i&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:i,groupId:n});return[(0,o.aZ)(s),(0,t.useCallback)((e=>{if(!s)return;const i=new URLSearchParams(r.location.search);i.set(s,e),r.replace({...r.location,search:i.toString()})}),[s,r])]}function m(e){const{defaultValue:i,queryString:n=!1,groupId:r}=e,s=p(e),[a,o]=(0,t.useState)((()=>function(e){let{defaultValue:i,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(i){if(!h({value:i,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${i}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return i}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:i,tabValues:s}))),[c,d]=f({queryString:n,groupId:r}),[m,g]=function(e){let{groupId:i}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(i),[r,s]=(0,u.Dv)(n);return[r,(0,t.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:r}),x=(()=>{const e=c??m;return h({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{x&&o(x)}),[x]);return{selectedValue:a,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),g(e)}),[d,g,s]),tabValues:s}}var g=n(92303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(74848);function v(e){let{className:i,block:n,selectedValue:t,selectValue:a,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const i=e.currentTarget,n=o.indexOf(i),r=l[n].value;r!==t&&(c(i),a(r))},d=e=>{let i=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=o.indexOf(e.currentTarget)+1;i=o[n]??o[0];break}case"ArrowLeft":{const n=o.indexOf(e.currentTarget)-1;i=o[n]??o[o.length-1];break}}i?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},i),children:l.map((e=>{let{value:i,label:n,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:t===i?0:-1,"aria-selected":t===i,ref:e=>o.push(e),onKeyDown:d,onClick:u,...s,className:(0,r.A)("tabs__item",x.tabItem,s?.className,{"tabs__item--active":t===i}),children:n??i},i)}))})}function k(e){let{lazy:i,children:n,selectedValue:s}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(i){const e=a.find((e=>e.props.value===s));return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map(((e,i)=>(0,t.cloneElement)(e,{key:i,hidden:e.props.value!==s})))})}function w(e){const i=m(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",x.tabList),children:[(0,b.jsx)(v,{...i,...e}),(0,b.jsx)(k,{...i,...e})]})}function y(e){const i=(0,g.A)();return(0,b.jsx)(w,{...e,children:d(e.children)},String(i))}},28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>l});var t=n(96540);const r={},s=t.createContext(r);function a(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);