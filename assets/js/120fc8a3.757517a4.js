"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[4069],{9902:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>m,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var n=r(4848),a=r(8453),s=r(1470),i=r(9365);const o={},l="Adding items to a Tar archive with QuickTar",c={id:"code-snippets/tar-gzip-capabilities/creating-writing/adding-item-tar-quicktar",title:"Adding items to a Tar archive with QuickTar",description:"This topic demonstrates how to add items to a Tar archive using the static Tar method of the QuickTar class, specifying several parameters.",source:"@site/zip/code-snippets/tar-gzip-capabilities/creating-writing/adding-item-tar-quicktar.md",sourceDirName:"code-snippets/tar-gzip-capabilities/creating-writing",slug:"/code-snippets/tar-gzip-capabilities/creating-writing/adding-item-tar-quicktar",permalink:"/xceed-docs-words/zip/code-snippets/tar-gzip-capabilities/creating-writing/adding-item-tar-quicktar",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarzip",previous:{title:"Removing items from a tar archive",permalink:"/xceed-docs-words/zip/code-snippets/tar-gzip-capabilities/creating-writing/removing-item-from-tar"},next:{title:"Removing items from a Tar archive with QuickTar",permalink:"/xceed-docs-words/zip/code-snippets/tar-gzip-capabilities/creating-writing/removing-item-from-tar-quicktar"}},u={},d=[{value:"Tar method",id:"tar-method",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Things you should consider",id:"things-you-should-consider",level:2}];function h(e){const t={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"adding-items-to-a-tar-archive-with-quicktar",children:"Adding items to a Tar archive with QuickTar"})}),"\n",(0,n.jsxs)(t.p,{children:["This topic demonstrates how to add items to a Tar archive using the static ",(0,n.jsx)(t.code,{children:"Tar"})," method of the ",(0,n.jsx)(t.code,{children:"QuickTar"})," class, specifying several parameters."]}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsx)(t.p,{children:"Tar is not currently available in Xceed's Compact Framework products."})}),"\n",(0,n.jsx)(t.h2,{id:"tar-method",children:"Tar method"}),"\n",(0,n.jsx)(t.p,{children:'The Tar method has various overloads that can be used to add files to a Tar archive. Some only require that you specify the archive name and the files to add to the archive, while others provide options such as whether existing files should be replaced and the directory structure preserved in the destination Tar archive, whether the Tar operation should be performed recursively, and whether the archive should be compressed using GZip to "tarFileName".gz. Events are also supported.'}),"\n",(0,n.jsx)(t.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,n.jsx)(t.p,{children:"In the following example, we specify several parameters and also use some callbacks."}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(i.A,{value:"csharp",label:"C#",default:!0,children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",children:'    QuickTar.Tar(@"d:\\test.tar", false, true, true,\r\n                new QuickTar.ByteProgressionCallback(this.OnByteProgression),\r\n                new QuickTar.ItemProgressionCallback(this.OnItemProgression),\r\n                null, @"d:\\test\\*");\r\n\r\n    public void OnByteProgression( string currentItemName, long currentItemsByteProcessed,\r\n                                  long currentItemTotalBytes, byte currentItemPercent,\r\n                                  long allItemsByteProcessed, long allItemsTotalBytes,\r\n                                  byte allItemsPercent, object userParams)\r\n    { \r\n      //Do stuff\r\n    }\r\n\r\n    public void OnItemProgression( string currentItemName, long itemProcessed,\r\n                                  long totalItemCount, byte totalItemPercent,\r\n                                  ref bool abort, object userParams)\r\n    { \r\n      //Do stuff\r\n    }\n'})})}),(0,n.jsx)(i.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-vb.NET",children:'  QuickTar.Tar("d:\\test.tar", False, True, True, _\r\n              New QuickTar.ByteProgressionCallback(Me.OnByteProgression), _\r\n              New QuickTar.ItemProgressionCallback(Me.OnItemProgression), _\r\n              Nothing, "d:\\test\\*")\r\n\r\n  Public Sub OnByteProgression(ByVal currentItemName As String, _\r\n                              ByVal currentItemsByteProcessed As Long, _\r\n                              ByVal currentItemTotalBytes As Long, _\r\n                              ByVal currentItemPercent As Byte, _\r\n                              ByVal allItemsByteProcessed As Long, _\r\n                              ByVal allItemsTotalBytes As Long, _\r\n                              ByVal allItemsPercent As Byte, _\r\n                              ByVal userParams As Object) \r\n\r\n    \'Do stuff\r\n  End Sub\r\n\r\n  Public Sub OnItemProgression(ByVal currentItemName As String, _\r\n                              ByVal itemProcessed As Long, _\r\n                              ByVal totalItemCount As Long, _\r\n                              ByVal totalItemPercent As Byte, _\r\n                              ByRef abort As Boolean, _\r\n                              ByVal userParams As Object) \r\n    \'Do stuff\r\n  End Sub\n'})})})]}),"\n",(0,n.jsx)(t.h2,{id:"remarks",children:"Remarks"}),"\n",(0,n.jsxs)(t.p,{children:["When recursively adding files to a zip file, you have to consider every filename you place in the ",(0,n.jsx)(t.em,{children:"filesToTar"})," parameter as a filemask. For example, if you set the ",(0,n.jsx)(t.em,{children:"filesToTar"}),' parameter to "c:\\file.txt", the ',(0,n.jsx)(t.strong,{children:"entire"}),' "c:" drive will be scanned and all the files that are named "file.txt" that are found will be included in the Tar archive.']}),"\n",(0,n.jsxs)(t.p,{children:["Note that the filesToTar parameter of the Tar method cannot be null; otherwise, an ",(0,n.jsx)(t.code,{children:"ArgumentNullException"})," exception will be thrown."]}),"\n",(0,n.jsx)(t.h2,{id:"things-you-should-consider",children:"Things you should consider"}),"\n",(0,n.jsx)(t.p,{children:"The main questions you should ask yourself when adding items to a Tar archive are:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Do you want to do more complex Tar operations? Use the ",(0,n.jsx)(t.code,{children:"FileSystem"}),"-based classes defined within the ",(0,n.jsx)(t.code,{children:"Xceed.Tar"})," namespace."]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9365:(e,t,r)=>{r.d(t,{A:()=>i});r(6540);var n=r(4164);const a={tabItem:"tabItem_Ymn6"};var s=r(4848);function i(e){let{children:t,hidden:r,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(a.tabItem,i),hidden:r,children:t})}},1470:(e,t,r)=>{r.d(t,{A:()=>w});var n=r(6540),a=r(4164),s=r(3104),i=r(6347),o=r(205),l=r(7485),c=r(1682),u=r(679);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:a}}=e;return{value:t,label:r,attributes:n,default:a}}))}(r);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function m(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function p(e){let{queryString:t=!1,groupId:r}=e;const a=(0,i.W6)(),s=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function g(e){const{defaultValue:t,queryString:r=!1,groupId:a}=e,s=h(e),[i,l]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:s}))),[c,d]=p({queryString:r,groupId:a}),[g,f]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,u.Dv)(r);return[a,(0,n.useCallback)((e=>{r&&s.set(e)}),[r,s])]}({groupId:a}),b=(()=>{const e=c??g;return m({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{b&&l(b)}),[b]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,s]),tabValues:s}}var f=r(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=r(4848);function y(e){let{className:t,block:r,selectedValue:n,selectValue:i,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const t=e.currentTarget,r=l.indexOf(t),a=o[r].value;a!==n&&(c(t),i(a))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const r=l.indexOf(e.currentTarget)+1;t=l[r]??l[0];break}case"ArrowLeft":{const r=l.indexOf(e.currentTarget)-1;t=l[r]??l[l.length-1];break}}t?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":r},t),children:o.map((e=>{let{value:t,label:r,attributes:s}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>l.push(e),onKeyDown:d,onClick:u,...s,className:(0,a.A)("tabs__item",b.tabItem,s?.className,{"tabs__item--active":n===t}),children:r??t},t)}))})}function T(e){let{lazy:t,children:r,selectedValue:s}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===s));return e?(0,n.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==s})))})}function x(e){const t=g(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,v.jsx)(y,{...t,...e}),(0,v.jsx)(T,{...t,...e})]})}function w(e){const t=(0,f.A)();return(0,v.jsx)(x,{...e,children:d(e.children)},String(t))}},8453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>o});var n=r(6540);const a={},s=n.createContext(a);function i(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);