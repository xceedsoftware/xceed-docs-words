"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[3273],{1680:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>h});var r=n(74848),a=n(28453),i=n(11470),s=n(19365);const o={},c="Public Key Authentication",l={id:"basic-concepts/sftp-capabilities/public-key-auth",title:"Public Key Authentication",description:"SSHClient supports public key authentication. Depending on the requirements of the SSH server, it can be used instead of or alongside password authentication.",source:"@site/ftp/basic-concepts/sftp-capabilities/public-key-auth.md",sourceDirName:"basic-concepts/sftp-capabilities",slug:"/basic-concepts/sftp-capabilities/public-key-auth",permalink:"/xceed-libs-doc/ftp/basic-concepts/sftp-capabilities/public-key-auth",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarftp",previous:{title:"Proxy Support",permalink:"/xceed-libs-doc/ftp/basic-concepts/sftp-capabilities/proxy-support"},next:{title:"Keyboard Interactive Authentication",permalink:"/xceed-libs-doc/ftp/basic-concepts/sftp-capabilities/keyboard-interactive-auth"}},u={},h=[{value:"PPK files",id:"ppk-files",level:3}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"public-key-authentication",children:"Public Key Authentication"})}),"\n",(0,r.jsx)(t.p,{children:"SSHClient supports public key authentication. Depending on the requirements of the SSH server, it can be used instead of or alongside password authentication."}),"\n",(0,r.jsx)(t.p,{children:"To use public key authentication, you need to load a private key file. The component supports the PPK format as generated by the PuTTYgen utility (an RSA and DSA key generation utility). This format was chosen for these reasons:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"It is easy to create and manipulate keys with the utility."}),"\n",(0,r.jsx)(t.li,{children:"The format is secure."}),"\n",(0,r.jsx)(t.li,{children:"It has good support on Windows."}),"\n",(0,r.jsx)(t.li,{children:"The utility can import keys from different formats to the PPK format."}),"\n",(0,r.jsxs)(t.li,{children:["You can get the puttygen utility from the PuTTY website (direct link: ",(0,r.jsx)(t.a,{href:"http://the.earth.li/~sgtatham/putty/latest/x86/puttygen.exe",children:"http://the.earth.li/~sgtatham/putty/latest/x86/puttygen.exe"}),")."]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"The PuTTYPrivateKeyFile class implements the PPK file format. Load your private key file into the class by using the Read() method or the constructor. The class takes the data from a Stream object that you supply or from an AbstractFile and a passphrase (if used) to decrypt the private key."}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"The passphrase can be a string or a byte array (generated by encoding the passphrase string into ASCII bytes)."})}),"\n",(0,r.jsx)(t.p,{children:"The passphrase can be a string or a byte array (generated by encoding the passphrase string into ASCII bytes)."}),"\n",(0,r.jsx)(t.p,{children:"The Read method will throw an SSHIncorrectPasswordException if the passphrase for the private key is incorrect. It will throw an SSHPublicKeyAuthenticationDataException if the private key file is malformed, uses unsupported algorithms, or if the message authenticity code check for the private key fails when an unencrypted private key file is used."}),"\n",(0,r.jsx)(t.p,{children:"Once you've successfully loaded your private key file into a PuTTYPrivateKeyFile object, you supply that object to the Authenticate method. The method has a flavor that takes a username string and a ISSHPublicKeyAuthenticationData object. PuTTYPrivateKeyFile implements this interface."}),"\n",(0,r.jsx)(t.p,{children:"Authenticate() will throw a SSHAuthenticationFailedException if the public key is rejected by the server. Authenticate() will throw a SSHAuthenticationPartialSuccessException if the public key is accepted by the server but more authentications are required. If that happens, you can then call Authenticate again with your username and password to attempt the 'password' authentication method."}),"\n",(0,r.jsx)(t.h3,{id:"ppk-files",children:"PPK files"}),"\n",(0,r.jsx)(t.p,{children:"The PPK file format has multiple versions: 1, 2 and 3. All versions are written as .ppk files. Version 1 files are very old and no longer used in the field. Version 2 files are the most common. Starting with PuTTY version 0.75, version 3 of the file format was introduced. The PuTTYPrivateKeyFile class only supports version 2 files. An exception will be thrown if a version 3 files is loaded by the class."}),"\n",(0,r.jsx)(t.p,{children:"Using the puttygen utility, it is possible to convert a version 3 PPK file to a version 2 PPK file."}),"\n",(0,r.jsxs)(i.A,{children:[(0,r.jsx)(s.A,{value:"csharp",label:"C#",default:!0,children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-csharp",children:'  using Xceed.SSH.Client;\r\n  using Xceed.SSH.Core;\r\n  using Xceed.SSH.Protocols;\r\n\r\n  using Xceed.FileSystem;\r\n\r\n  namespace DocumentationExamples.SSH\r\n  {\r\n    class PublicKeyAuthentication1\r\n    {\r\n      static void Example()\r\n      {\r\n        string host = "sftptest.dreamhosters.com";\r\n        string username = "snippet_sftp";\r\n\r\n        using( SSHClient ssh = new SSHClient() )\r\n        {\r\n          ssh.Connect( host );\r\n\r\n          // Get the private key file\r\n          AbstractFile privateKeyFile = new DiskFile( @"D:\\MyPrivateKey.ppk" );\r\n          \r\n          // The key file has a passphrase we will need to read it\r\n          string passphrase = "mypassphrase";\r\n\r\n          // Create a PuTTYPrivate key file object\r\n          PuTTYPrivateKeyFile privateKey = new PuTTYPrivateKeyFile();\r\n\r\n          // Decrypt the key file using the passphrase\r\n          privateKey.Read( privateKeyFile, passphrase );\r\n\r\n          try\r\n          {\r\n            // Authenticate using the private key file object we set up\r\n            ssh.Authenticate( username, privateKey );\r\n\r\n            /* ... */\r\n          }\r\n          // These exceptions can be thrown by a call to Authenticate()\r\n          catch( SSHIncorrectPasswordException )\r\n          {\r\n            // This means the authentication method is supported by the server but the password\r\n            // was incorrect for the specified username \r\n            throw;\r\n          }\r\n          catch( SSHAuthenticationPartialSuccessException )\r\n          {\r\n            // This means the authentication was successful but the server requires an additional authentication\r\n            // using another method specified in the exception information\r\n            throw;\r\n          }\r\n          catch( SSHUnsupportedAuthenticationMethodException )\r\n          {\r\n            // This means the authentication method is not supported by the server\r\n            throw;\r\n          }\r\n          catch( SSHAuthenticationFailedException )\r\n          {\r\n            // This means the authentication method failed\r\n            throw;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\n'})})}),(0,r.jsx)(s.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-vb.NET",children:"  Imports Xceed.SSH.Client\r\n  Imports Xceed.SSH.Core\r\n  Imports Xceed.SSH.Protocols\r\n\r\n  Imports Xceed.FileSystem\r\n\r\n  Namespace DocumentationExamples.SSH\r\n    Friend Class PublicKeyAuthentication1\r\n      Private Shared Sub Example()\r\n        Dim host As String = \"sftptest.dreamhosters.com\"\r\n        Dim username As String = \"snippet_sftp\"\r\n\r\n        Using ssh As New SSHClient()\r\n          ssh.Connect(host)\r\n\r\n          ' Get the private key file\r\n          Dim privateKeyFile As AbstractFile = New DiskFile(\"D:\\MyPrivateKey.ppk\")\r\n\r\n          ' The key file has a passphrase we will need to read it\r\n          Dim passphrase As String = \"mypassphrase\"\r\n\r\n          ' Create a PuTTYPrivate key file object\r\n          Dim privateKey As New PuTTYPrivateKeyFile()\r\n\r\n          ' Decrypt the key file using the passphrase\r\n          privateKey.Read(privateKeyFile, passphrase)\r\n\r\n          Try\r\n            ' Authenticate using the private key file object we set up\r\n            ssh.Authenticate(username, privateKey)\r\n\r\n            '... \r\n          ' These exceptions can be thrown by a call to Authenticate()\r\n          Catch e1 As SSHIncorrectPasswordException\r\n            ' This means the authentication method is supported by the server but the password\r\n            ' was incorrect for the specified username \r\n            Throw\r\n          Catch e2 As SSHAuthenticationPartialSuccessException\r\n            ' This means the authentication was successful but the server requires an additional authentication\r\n            ' using another method specified in the exception information\r\n            Throw\r\n          Catch e3 As SSHUnsupportedAuthenticationMethodException\r\n            ' This means the authentication method is not supported by the server\r\n            Throw\r\n          Catch e4 As SSHAuthenticationFailedException\r\n            ' This means the authentication method failed\r\n            Throw\r\n          End Try\r\n        End Using\r\n      End Sub\r\n    End Class\r\n  End Namespace\n"})})})]})]})}function d(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>s});n(96540);var r=n(34164);const a={tabItem:"tabItem_Ymn6"};var i=n(74848);function s(e){let{children:t,hidden:n,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(a.tabItem,s),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(96540),a=n(34164),i=n(23104),s=n(56347),o=n(205),c=n(57485),l=n(31682),u=n(70679);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return h(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,l.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function d(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.W6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=p(e),[s,c]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[l,h]=f({queryString:n,groupId:a}),[m,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,u.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),y=(()=>{const e=l??m;return d({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{y&&c(y)}),[y]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!d({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);c(e),h(e),b(e)}),[h,b,i]),tabValues:i}}var b=n(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=n(74848);function g(e){let{className:t,block:n,selectedValue:r,selectValue:s,tabValues:o}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,i.a_)(),u=e=>{const t=e.currentTarget,n=c.indexOf(t),a=o[n].value;a!==r&&(l(t),s(a))},h=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>c.push(e),onKeyDown:h,onClick:u,...i,className:(0,a.A)("tabs__item",y.tabItem,i?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function S(e){let{lazy:t,children:n,selectedValue:i}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==i})))})}function x(e){const t=m(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",y.tabList),children:[(0,v.jsx)(g,{...t,...e}),(0,v.jsx)(S,{...t,...e})]})}function w(e){const t=(0,b.A)();return(0,v.jsx)(x,{...e,children:h(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>o});var r=n(96540);const a={},i=r.createContext(a);function s(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);