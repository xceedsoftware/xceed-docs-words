"use strict";(self.webpackChunkxceed_docs_words=self.webpackChunkxceed_docs_words||[]).push([[2696],{23392:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var n=t(74848),r=t(28453),s=t(11470),o=t(19365);const l={},a="Creating split zip files",c={id:"code-snippets/zipping/create-split-zip",title:"Creating split zip files",description:"Xceed Zip for .NET allows you to create split zip files which have the PkZip or Xceed Zip ActiveX naming conventions through the use of the SplitNameFormat and SplitSize properties of the ZipArchive class, as well as the option to create your own custom naming convention by also handling the DiskRequired event and changing the ZipFile property of the event arguments.",source:"@site/zip/code-snippets/zipping/create-split-zip.md",sourceDirName:"code-snippets/zipping",slug:"/code-snippets/zipping/create-split-zip",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/create-split-zip",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebarzip",previous:{title:"Creating spanned zip files",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/create-spanned-zip"},next:{title:"Creating a Zip archive using ZipWriter",permalink:"/xceed-libs-doc/zip/code-snippets/zipping/create-zip-archive-zipwriter"}},d={},p=[{value:"Basic steps",id:"basic-steps",level:2},{value:"Demonstration",id:"demonstration",level:2},{value:"Things you should consider",id:"things-you-should-consider",level:2}];function h(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.header,{children:(0,n.jsx)(i.h1,{id:"creating-split-zip-files",children:"Creating split zip files"})}),"\n",(0,n.jsxs)(i.p,{children:["Xceed Zip for .NET allows you to create split zip files which have the PkZip or Xceed Zip ActiveX naming conventions through the use of the ",(0,n.jsx)(i.code,{children:"SplitNameFormat"})," and ",(0,n.jsx)(i.code,{children:"SplitSize"})," properties of the ",(0,n.jsx)(i.code,{children:"ZipArchive"})," class, as well as the option to create your own custom naming convention by also handling the ",(0,n.jsx)(i.code,{children:"DiskRequired"})," event and changing the ZipFile property of the event arguments."]}),"\n",(0,n.jsx)(i.h2,{id:"basic-steps",children:"Basic steps"}),"\n",(0,n.jsx)(i.p,{children:"To create a split zip file, the following steps must be performed:"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Retrieve a reference to a folder whose files will be added to the zip file, using either the ",(0,n.jsx)(i.code,{children:"DiskFolder"}),", ",(0,n.jsx)(i.code,{children:"ZippedFolder"}),", ",(0,n.jsx)(i.code,{children:"ZipArchive"}),", ",(0,n.jsx)(i.code,{children:"MemoryFolder"})," or ",(0,n.jsx)(i.code,{children:"IsolatedFolder"})," classes. With Xceed Zip for .NET, a folder is a folder; it does not matter if it is located within a zip file, on disk or in memory."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Retrieve a reference to a new or existing zip file using the ",(0,n.jsx)(i.code,{children:"ZipArchive"})," class. **The last part or the part that has the .zip extension must be used when creating an instance of the ZipArchive class. **"]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Set the ",(0,n.jsx)(i.code,{children:"SplitNameFormat"})," and ",(0,n.jsx)(i.code,{children:"SplitSize"})," properties of the ZipArchive object to the desired values. If you want to provide your own custom naming convention, set the SplitNameFormat property to ",(0,n.jsx)(i.code,{children:"SplitNameFormat.None"}),". In this case, you ",(0,n.jsx)(i.strong,{children:"must"})," handle the ",(0,n.jsx)(i.code,{children:"DiskRequired"})," event."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.admonition,{type:"caution",children:(0,n.jsx)(i.p,{children:"It is important to note that setting the SplitNameFormat and SplitSize properties will not automatically update the zip file. The zip file will only be updated at the next operation (for example, when files are added to the zip file or when the zip file's comment is modified )."})}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["If you want to provide your own custom naming convention, then you will need to subscribe to the ",(0,n.jsx)(i.code,{children:"DiskRequired"})," event. You can also use the ",(0,n.jsx)(i.code,{children:"DiskRequired"})," event to change the location where the split zip file parts are created and the size of each split part."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Call the ",(0,n.jsx)(i.code,{children:"CopyFilesTo"})," method to copy the entire contents of the folder to the zip file."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.h2,{id:"demonstration",children:"Demonstration"}),"\n",(0,n.jsx)(i.p,{children:"The following example demonstrates how to create a split zip file with the PkZip naming convention."}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(o.A,{value:"csharp",label:"C#",default:!0,children:(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:'  using Xceed.Zip;\r\n  using Xceed.Zip.Sfx;\r\n  using Xceed.FileSystem;\r\n\r\n  ZipArchive zip = new ZipArchive( new DiskFile( @"d:\\split\\test.zip" ) );\r\n  DiskFolder source = new DiskFolder( @"c:\\windows\\fonts" ); \r\n\r\n  zip.SplitNameFormat = SplitNameFormat.PkZip;\r\n  zip.SplitSize = 1000000; \r\n\r\n  source.CopyFilesTo( zip, true, true );\n'})})}),(0,n.jsx)(o.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-vb.NET",children:'    Imports Xceed.Zip\r\n    Imports Xceed.Zip.Sfx\r\n    Imports Xceed.FileSystem\r\n\r\n    Dim zip As New ZipArchive( new DiskFile( "d:\\split\\test.zip" ) )\r\n    Dim source As New DiskFolder( "c:\\windows\\fonts" ) \r\n\r\n    zip.SplitNameFormat = SplitNameFormat.PkZip\r\n    zip.SplitSize = 1000000 \r\n\r\n    source.CopyFilesTo( zip, True, True )\n'})})})]}),"\n",(0,n.jsx)(i.p,{children:"The next example demonstrates how to create a split zip file where each split part is located in a different folder and has the .zip extension."}),"\n",(0,n.jsxs)(s.A,{children:[(0,n.jsx)(o.A,{value:"csharp",label:"C#",default:!0,children:(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-csharp",children:"  ZipEvents zipEvents = new ZipEvents();\r\n  zipEvents.DiskRequired += new DiskRequiredEventHandler( this.OnDiskRequired );\r\n\r\n  /*Once the user has confirmed that the appropriate disk is in the drive, set the DiskRequiredAction\r\n  to Continue. Setting the Action to Fail will not cause the whole operation to fail, but only the deleting step to be skipped.*/\n"})})}),(0,n.jsx)(o.A,{value:"vb.net",label:"Visual Basic .NET",children:(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-vb.NET",children:'    Dim WithEvents zipEvents As New ZipEvents()\r\n    AddHandler zipEvents.DiskRequired, AddressOf Me.OnDiskRequired\r\n\r\n    \' The first split zip file part will be located in the "1" folder.\r\n    \' All subsequent parts will be located in folders representing their part number.\r\n    Dim zip As New ZipArchive(zipEvents, Nothing, New DiskFile("d:\\split\\1\\test.zip"))\r\n\r\n    Dim source As New DiskFolder("c:\\windows\\fonts")\r\n\r\n    zip.SplitNameFormat = SplitNameFormat.None\r\n    zip.SplitSize = 1000000\r\n\r\n    source.CopyFilesTo( zipEvents, Nothing, zip, True, True )\r\n\r\n    \' This method will handle the DiskRequired events that are raised.\r\n    \' In it, we change the folder in which the part will be created.\r\n    Private Sub OnDiskRequired(ByVal sender As Object, ByVal e As DiskRequiredEventArgs)\r\n\r\n      e.ZipFile = New DiskFile(e.ZipFile.ParentFolder.ParentFolder.GetFolder((e.DiskNumber).ToString()).FullName + e.ZipFile.Name)\r\n\r\n      e.Action = DiskRequiredAction.Continue\r\n    End Sub\n'})})})]}),"\n",(0,n.jsx)(i.h2,{id:"things-you-should-consider",children:"Things you should consider"}),"\n",(0,n.jsx)(i.p,{children:"The main questions you should ask yourself when copying items to a zip file are:"}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you want to move items rather than copy them? Use the ",(0,n.jsx)(i.code,{children:"MoveTo"})," and ",(0,n.jsx)(i.code,{children:"MoveFilesTo"})," methods."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you want to change the location of the temporary folder. Set the ZipArchive's ",(0,n.jsx)(i.code,{children:"TempFolder"})," or ",(0,n.jsx)(i.code,{children:"DefaultTempFolder"})," property."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you want to filter (specify specific files and folders) the items that are to be added to the zip file? Use ",(0,n.jsx)(i.code,{children:"filters"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you only want to copy a specific file or folder? Use the ",(0,n.jsx)(i.code,{children:"CopyTo"})," method."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you want to add items into a specific folder within the self-extracting zip file? Create an instance of a ",(0,n.jsx)(i.code,{children:"ZippedFolder"})," object rather than a ",(0,n.jsx)(i.code,{children:"ZipArchive"})," object."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you only want to do basic zip file operations? Use the ",(0,n.jsx)(i.a,{href:"/zip/basic-concepts/quick-zip",children:"QuickZip"})," class."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["Do you want to modify the default extra headers that are stored to a zip file? Set the ZipArchive's ",(0,n.jsx)(i.code,{children:"DefaultExtraHeaders"})," property."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.p,{children:(0,n.jsxs)(i.strong,{children:["All zip files will automatically be created in the ",(0,n.jsx)(i.a,{href:"/zip/basic-concepts/zip64-zip-file-format",children:"Zip64 zip file format"})," if the limitations of the regular Zip format are reached."]})})]})}function u(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},19365:(e,i,t)=>{t.d(i,{A:()=>o});t(96540);var n=t(34164);const r={tabItem:"tabItem_Ymn6"};var s=t(74848);function o(e){let{children:i,hidden:t,className:o}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(r.tabItem,o),hidden:t,children:i})}},11470:(e,i,t)=>{t.d(i,{A:()=>z});var n=t(96540),r=t(34164),s=t(23104),o=t(56347),l=t(205),a=t(57485),c=t(31682),d=t(70679);function p(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:i}=e;return!!i&&"object"==typeof i&&"value"in i}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:i,children:t}=e;return(0,n.useMemo)((()=>{const e=i??function(e){return p(e).map((e=>{let{props:{value:i,label:t,attributes:n,default:r}}=e;return{value:i,label:t,attributes:n,default:r}}))}(t);return function(e){const i=(0,c.XI)(e,((e,i)=>e.value===i.value));if(i.length>0)throw new Error(`Docusaurus error: Duplicate values "${i.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[i,t])}function u(e){let{value:i,tabValues:t}=e;return t.some((e=>e.value===i))}function f(e){let{queryString:i=!1,groupId:t}=e;const r=(0,o.W6)(),s=function(e){let{queryString:i=!1,groupId:t}=e;if("string"==typeof i)return i;if(!1===i)return null;if(!0===i&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:i,groupId:t});return[(0,a.aZ)(s),(0,n.useCallback)((e=>{if(!s)return;const i=new URLSearchParams(r.location.search);i.set(s,e),r.replace({...r.location,search:i.toString()})}),[s,r])]}function m(e){const{defaultValue:i,queryString:t=!1,groupId:r}=e,s=h(e),[o,a]=(0,n.useState)((()=>function(e){let{defaultValue:i,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(i){if(!u({value:i,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${i}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return i}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:i,tabValues:s}))),[c,p]=f({queryString:t,groupId:r}),[m,x]=function(e){let{groupId:i}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(i),[r,s]=(0,d.Dv)(t);return[r,(0,n.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:r}),v=(()=>{const e=c??m;return u({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{v&&a(v)}),[v]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!u({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);a(e),p(e),x(e)}),[p,x,s]),tabValues:s}}var x=t(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=t(74848);function g(e){let{className:i,block:t,selectedValue:n,selectValue:o,tabValues:l}=e;const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),d=e=>{const i=e.currentTarget,t=a.indexOf(i),r=l[t].value;r!==n&&(c(i),o(r))},p=e=>{let i=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=a.indexOf(e.currentTarget)+1;i=a[t]??a[0];break}case"ArrowLeft":{const t=a.indexOf(e.currentTarget)-1;i=a[t]??a[a.length-1];break}}i?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},i),children:l.map((e=>{let{value:i,label:t,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:n===i?0:-1,"aria-selected":n===i,ref:e=>a.push(e),onKeyDown:p,onClick:d,...s,className:(0,r.A)("tabs__item",v.tabItem,s?.className,{"tabs__item--active":n===i}),children:t??i},i)}))})}function j(e){let{lazy:i,children:t,selectedValue:s}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(i){const e=o.find((e=>e.props.value===s));return e?(0,n.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:o.map(((e,i)=>(0,n.cloneElement)(e,{key:i,hidden:e.props.value!==s})))})}function w(e){const i=m(e);return(0,b.jsxs)("div",{className:(0,r.A)("tabs-container",v.tabList),children:[(0,b.jsx)(g,{...i,...e}),(0,b.jsx)(j,{...i,...e})]})}function z(e){const i=(0,x.A)();return(0,b.jsx)(w,{...e,children:p(e.children)},String(i))}},28453:(e,i,t)=>{t.d(i,{R:()=>o,x:()=>l});var n=t(96540);const r={},s=n.createContext(r);function o(e){const i=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);