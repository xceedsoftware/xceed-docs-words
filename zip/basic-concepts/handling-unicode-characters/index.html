<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-zip docs-version-current docs-doc-page docs-doc-id-basic-concepts/handling-unicode-characters" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Handling Unicode characters | Xceed Libraries for .NET</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xceedsoftware.github.io/xceed-libs-doc/img/xceed_front.png"><meta data-rh="true" name="twitter:image" content="https://xceedsoftware.github.io/xceed-libs-doc/img/xceed_front.png"><meta data-rh="true" property="og:url" content="https://xceedsoftware.github.io/xceed-libs-doc/zip/basic-concepts/handling-unicode-characters"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-zip-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-zip-current"><meta data-rh="true" property="og:title" content="Handling Unicode characters | Xceed Libraries for .NET"><meta data-rh="true" name="description" content="The original Zip specification does not support non-ASCII, international characters. Thanks to extensions to the specification, Unicode, the widespread standard for the encoding, representation and handling of text expressed in most of the world&#x27;s writing systems, is available to encode filenames and comments. Unicode support was added to the specification years after the original version. Because of this, Unicode support is not universal amongst zip tools. Some tools will not show or extract Unicode paths and files names correctly if at all."><meta data-rh="true" property="og:description" content="The original Zip specification does not support non-ASCII, international characters. Thanks to extensions to the specification, Unicode, the widespread standard for the encoding, representation and handling of text expressed in most of the world&#x27;s writing systems, is available to encode filenames and comments. Unicode support was added to the specification years after the original version. Because of this, Unicode support is not universal amongst zip tools. Some tools will not show or extract Unicode paths and files names correctly if at all."><link data-rh="true" rel="icon" href="/xceed-libs-doc/img/logox.ico"><link data-rh="true" rel="canonical" href="https://xceedsoftware.github.io/xceed-libs-doc/zip/basic-concepts/handling-unicode-characters"><link data-rh="true" rel="alternate" href="https://xceedsoftware.github.io/xceed-libs-doc/zip/basic-concepts/handling-unicode-characters" hreflang="en"><link data-rh="true" rel="alternate" href="https://xceedsoftware.github.io/xceed-libs-doc/zip/basic-concepts/handling-unicode-characters" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/xceed-libs-doc/blog/rss.xml" title="Xceed Libraries for .NET RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/xceed-libs-doc/blog/atom.xml" title="Xceed Libraries for .NET Atom Feed"><link rel="stylesheet" href="/xceed-libs-doc/assets/css/styles.6d770663.css">
<script src="/xceed-libs-doc/assets/js/runtime~main.b55e27b6.js" defer="defer"></script>
<script src="/xceed-libs-doc/assets/js/main.ad1d01d6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/xceed-libs-doc/"><div class="navbar__logo"><img src="/xceed-libs-doc/img/xceed_logo.svg" alt="Xceed Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/xceed-libs-doc/img/xceed_logo.svg" alt="Xceed Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Xceed documentation center</b></a><a class="navbar__item navbar__link" href="/xceed-libs-doc/docs/intro">Words for .NET</a><a class="navbar__item navbar__link" href="/xceed-libs-doc/workbooks/intro">Workbooks for .NET</a><a class="navbar__item navbar__link" href="/xceed-libs-doc/ftp/intro">Ftp for .NET</a><a class="navbar__item navbar__link" href="/xceed-libs-doc/zip/intro">Zip for .NET</a><a class="navbar__item navbar__link" href="/xceed-libs-doc/about">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xceedsoftware/Xceed-Words-Samples" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xceed-libs-doc/zip/intro">Zip for .NET</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/xceed-libs-doc/zip/installation-instructions/overview">Installation Instructions</a><button aria-label="Expand sidebar category &#x27;Installation Instructions&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/xceed-libs-doc/zip/basic-concepts/getting-started">Basic Concepts</a><button aria-label="Collapse sidebar category &#x27;Basic Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/zip-and-streaming-capabilities">Zip and streaming capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/introduction-zip-file-format">Introduction to the Zip File Format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/encryption-decription">Encryption and Decryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/listing-content-zip-file">Listing the Contents of a Zip File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/removing-items-from-zip-file">Removing Items from a Zip File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/optimizing-batch-updates-to-folder">Optimizing Batch Updates to a Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/handling-unicode-characters">Handling Unicode characters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/aes-ecryption">AES Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/zip64-zip-file-format">Zip64 zip file format</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/xceed-libs-doc/zip/category/zipping">Zipping</a><button aria-label="Expand sidebar category &#x27;Zipping&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/xceed-libs-doc/zip/category/unzipping">Unzipping</a><button aria-label="Expand sidebar category &#x27;Unzipping&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/quick-zip">QuickZip class</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/xceed-libs-doc/zip/basic-concepts/tar-gzip-capabilities/overview">Tar &amp; GZip capabilities</a><button aria-label="Expand sidebar category &#x27;Tar &amp; GZip capabilities&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/xceed-libs-doc/zip/category/advanced-concepts">Advanced Concepts</a><button aria-label="Expand sidebar category &#x27;Advanced Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/xceed-libs-doc/zip/category/code-snippets">Code Snippets</a><button aria-label="Expand sidebar category &#x27;Code Snippets&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/xceed-libs-doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/xceed-libs-doc/zip/basic-concepts/getting-started"><span itemprop="name">Basic Concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Handling Unicode characters</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Handling Unicode characters</h1></header>
<p>The original Zip specification does not support non-ASCII, international characters. Thanks to extensions to the specification, <a href="https://en.wikipedia.org/wiki/Unicode" target="_blank" rel="noopener noreferrer">Unicode</a>, the widespread standard for the encoding, representation and handling of text expressed in most of the world&#x27;s writing systems, is available to encode filenames and comments. Unicode support was added to the specification years after the original version. Because of this, Unicode support is not universal amongst zip tools. Some tools will not show or extract Unicode paths and files names correctly if at all.</p>
<p>All Xceed Zip components handle Unicode characters automatically by default, so this is not an issue if an application uses Xceed components to create, update and extract zip archives. Issues can arise when 3rd party zip tools with varying support for Unicode are used in some operations. This becomes an interoperability problem.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-unicode-support-for-zip-archives-with-xceed-zip-components">Types of Unicode support for zip archives with Xceed Zip components<a href="#types-of-unicode-support-for-zip-archives-with-xceed-zip-components" class="hash-link" aria-label="Direct link to Types of Unicode support for zip archives with Xceed Zip components" title="Direct link to Types of Unicode support for zip archives with Xceed Zip components">​</a></h2>
<p>A zip archive contains, for each file, meta-data about the items in the archive: the name and path of file/folder, optional comment, dates, compression method, etc. It is in the text-based meta-data that Unicode can be applied.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The path and filename of the zip file itself is not covered by the zip specification&#x27;s Unicode support. The name of the zip file is determined by your application and is governed by the rules of your operating system.</p></div></div>
<p>A zip archive is made up of the items (files or folders) archived one after the other. Each item is made up of a header, followed with the item&#x27;s compressed data. That header is made up of a standard set of fields followed by a sequence of optional extra headers. Meta-data is located in those headers. The most important field, with regards to Unicode is the filename field. That field is part of the standard set of fields for each item in an archive.</p>
<p>The Zip format has historically supported only the original IBM PC character encoding set, commonly referred to as <a href="https://en.wikipedia.org/wiki/Code_page_437" target="_blank" rel="noopener noreferrer">IBM Code Page 437</a>. This limits storing file name characters to only those within the original MS-DOS range of values and does not properly support file names in other character encodings, or languages. To solve this, several independent solutions exist:</p>
<ul>
<li>Xceed implemented an optional extra header definition where the file path and comment is read and/or written as Unicode (UTF-16, little endian), ignoring the value in the standard header. This solution is controlled by the <code>ZipArchive.DefaultExtraHeaders</code> property with the Unicode value. The Xceed Unicode extra header is deprecated and should not be used in new code.</li>
<li>Version 6.3.0 of the Zip specification added an option for Unicode (UTF-8) filename storage in the standard field, instead of using IBM character encoding. This solution is controlled by the <code>ZipArchive.DefaultTextEncoding</code> property with the Unicode value.</li>
<li>Version 6.3.2 of the Zip specification added an optional extra header definition where the file path and/or comment is read and/or written as Unicode (UTF-8), ignoring the value in the standard header. This solution is controlled by the <code>ZipArchive.DefaultExtraHeaders</code> property with the UTF8Filename value.</li>
</ul>
<p>Every flavor of Xceed Zip components support all these solutions. They can be activated (or not) independently of each other in any combination.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="unicode-interoperability">Unicode interoperability<a href="#unicode-interoperability" class="hash-link" aria-label="Direct link to Unicode interoperability" title="Direct link to Unicode interoperability">​</a></h2>
<p>Not every 3rd party zip tool support the Unicode options mentioned above. Some tools don&#x27;t support any of them, some support some of them. Often, Unicode support is not clearly advertised and if it is, it&#x27;s not clearly explained what method is used.</p>
<p>Interoperability is the ability of making different systems work together. In the case of Zip and Unicode, it applies when zip archives are created with Xceed Zip for .NET and will be extracted by other zip tools. It also applies when zip archives created by other zip tools are extracted by Xceed Zip for .NET.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zip-archives-created-by-3rd-party-zip-tools-extracted-by-xceed-zip-for-net">Zip archives created by 3rd party zip tools extracted by Xceed Zip for .NET<a href="#zip-archives-created-by-3rd-party-zip-tools-extracted-by-xceed-zip-for-net" class="hash-link" aria-label="Direct link to Zip archives created by 3rd party zip tools extracted by Xceed Zip for .NET" title="Direct link to Zip archives created by 3rd party zip tools extracted by Xceed Zip for .NET">​</a></h2>
<p>Xceed Zip for .NET (and all zip components from Xceed) supports all Unicode options defined in the Zip specification and a proprietary solution. This means that it should be able to automatically properly handle Unicode characters in any archive created by a 3rd party zip tool unless it uses a proprietary solution.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zip-archives-created-by-xceed-zip-for-net-extracted-by-3rd-party-zip-tools">Zip archives created by Xceed Zip for .NET extracted by 3rd party zip tools<a href="#zip-archives-created-by-xceed-zip-for-net-extracted-by-3rd-party-zip-tools" class="hash-link" aria-label="Direct link to Zip archives created by Xceed Zip for .NET extracted by 3rd party zip tools" title="Direct link to Zip archives created by Xceed Zip for .NET extracted by 3rd party zip tools">​</a></h2>
<p>Because not every 3rd party zip tool supports Unicode options, interoperability problems are likely in this situation if filenames or comments contain non-ASCII characters. The symptoms will be that these filenames will contain incorrect characters when viewed or extracted by 3rd party tools that don&#x27;t support Unicode.</p>
<p>Even if some Unicode options are enabled when you create archives with Xceed Zip for .NET, if a 3rd party zip tool doesn&#x27;t support that specific option, filenames will appear incorrectly.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Remember that Unicode issues only affect the meta data of an item, not the file data itself.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="default-behavior">Default behavior<a href="#default-behavior" class="hash-link" aria-label="Direct link to Default behavior" title="Direct link to Default behavior">​</a></h2>
<p>To show the effects of interoperability problems, we will use an example where a zip archive is created to contain two files. The first file will be named &quot;FileNameWithNonASCIIStartÀÉяテEnd.dat&quot; and will have the comment &quot;私のコメント&quot;. The second file&#x27;s name will be, &quot;FileNameWithOEMCharsStartéàùïEnd.dat&quot; and will not have any comment.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Code: Creating an archive using the default Unicode behavior</summary><div><div class="collapsibleContent_i85q"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">C#</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Visual Basic .NET</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">DefaultBehavior</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">/* The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * governed by the rules of your operating system. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> zipFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;DefaultBehavior.zip&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Delete any existing zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Exists </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Create a logical zip archive around the zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">ZipArchive</span><span class="token plain"> zip </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ZipArchive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">string</span><span class="token plain"> destinationPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> sourceFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token class-name">AutoBatchUpdate</span><span class="token plain"> batch </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">AutoBatchUpdate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zip </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">/* We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * without issue by any editor. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithNonASCIIStart\u00C0\u00C9\u044F\u30C6End.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token class-name">ZippedFile</span><span class="token plain"> destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// The string &quot;My comment&quot; in Japanese</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Comment </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\u79C1\u306E\u30B3\u30E1\u30F3\u30C8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithOEMCharsStartéàùïEnd.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-vb.NET language-vb.net codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb.net codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Public Shared Sub DefaultBehavior()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * governed by the rules of your operating system. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zipFile As AbstractFile = New DiskFile(&quot;DefaultBehavior.zip&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Delete any existing zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  If zipFile.Exists Then</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zipFile.Delete()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End If</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Create a logical zip archive around the zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zip As New ZipArchive(zipFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim destinationPath As String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim sourceFile As AbstractFile = New DiskFile(&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using batch As New AutoBatchUpdate(zip)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * without issue by any editor. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithNonASCIIStart&quot; &amp; ChrW(&amp;H00C0).ToString() &amp; ChrW(&amp;H00C9).ToString() &amp; ChrW(&amp;H044F).ToString() &amp; ChrW(&amp;H30C6).ToString() &amp; &quot;End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Dim destinationFile As ZippedFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27; The string &quot;My comment&quot; in Japanese</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile.Comment = ChrW(&amp;H79C1).ToString() &amp; ChrW(&amp;H306E).ToString() &amp; ChrW(&amp;H30B3).ToString() &amp; ChrW(&amp;H30E1).ToString() &amp; ChrW(&amp;H30F3).ToString() &amp; ChrW(&amp;H30C8).ToString()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithOEMCharsStart����End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End Using</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></div></div></details>
<p>Using a modern 3rd party zip tool like WinZip, the archive shows 2 files and you see the names displayed correctly. This is because the default behavior of Xceed Zip for .NET is to create archives with the ExtraHeader.UTF8Filename and ExtraHeader.UTF8Comment options. These extra headers are supported by WinZip so the Unicode characters appear correctly.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Default behavior seen in WinZip</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Default behavior seen in WinZip" src="/xceed-libs-doc/assets/images/01-60d44be69c8be5e16f6fa599f0c8e929.png" width="747" height="213" class="img_ev3q"></p></div></div></details>
<p>If we open the same zip file but, this time, with Windows Explorer on Windows 7, we see something completely different. The first thing we notice is that the &quot;FileNameWithNonASCIIStartÀÉяテEnd.dat&quot; file seems to be gone. While it is present in the zip file, Explorer chooses not to display it because the file name was written as &quot;FileNameWithNonASCIIStart?É??End.dat&quot; in the main header The non-ASCII characters were written as &#x27;?&#x27;. This is the standard behavior in .NET&#x27;s %System.Text.Encoding% class. Windows Explorer does not support the Unicode (UTF8) extra header so it uses the filenames in the main header. The &#x27;?&#x27; character is illegal in filenames under Windows, so Windows Explorer chooses not to display the filename, a rather unfortunate behavior.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Default behavior seen in Windows Explorer 7</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Default behavior seen in Windows Explorer 7" src="/xceed-libs-doc/assets/images/02-a93a70862cf1f5465081b7ef9f5ecb12.png" width="892" height="327" class="img_ev3q"></p></div></div></details>
<p>In Windows 8, it appears Microsoft has improved the quality of its built-in Zip to support both Unicode extra headers and Unicode text encoding. So the default behavior from Xceed Zip for .NET produces the expected results.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Default behavior seen in Windows Explorer 8</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Default behavior seen in Windows Explorer 8" src="/xceed-libs-doc/assets/images/03-86bc8981c50ecd3fd630197248f0a55f.png" width="1076" height="429" class="img_ev3q"></p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="maximum-interoperability">Maximum interoperability<a href="#maximum-interoperability" class="hash-link" aria-label="Direct link to Maximum interoperability" title="Direct link to Maximum interoperability">​</a></h2>
<p>Xceed Zip for .NET provides control over how non-ASCII characters are converted into ASCII. The ZipArchive.UnknownCharacterFallbackConversion property specifies what character ASCII should be used when a Unicode character cannot be expressed in ASCII when writing zip files. The default value is &#x27;?&#x27;.</p>
<p>We can update the previous example to improve interoperability on Windows</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Code: Create a zip archive aiming for maximum interoperability</summary><div><div class="collapsibleContent_i85q"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">C#</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Visual Basic .NET</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">MaximumInteroperability</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">/* The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * governed by the rules of your operating system. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> zipFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;MaximumInteroperability.zip&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Delete any existing zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Exists </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Create a logical zip archive around the zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">ZipArchive</span><span class="token plain"> zip </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ZipArchive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Disable the use of any OEM code page mandated by the local machine policy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">UseLocalMachineOEMCodePageForFilenames </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Specify the &#x27;_&#x27; character for characters that can&#x27;t be converted</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">UnknownCharacterFallbackConversion </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0x5f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// &#x27;_&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">string</span><span class="token plain"> destinationPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> sourceFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token class-name">AutoBatchUpdate</span><span class="token plain"> batch </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">AutoBatchUpdate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zip </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">/* We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * without issue by any editor. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithNonASCIIStart\u00C0\u00C9\u044F\u30C6End.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token class-name">ZippedFile</span><span class="token plain"> destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// The string &quot;My comment&quot; in Japanese</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Comment </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\u79C1\u306E\u30B3\u30E1\u30F3\u30C8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithOEMCharsStartéàùïEnd.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-vb.NET language-vb.net codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb.net codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Public Shared Sub MaximumInteroperability()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * governed by the rules of your operating system. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zipFile As AbstractFile = New DiskFile(&quot;MaximumInteroperability.zip&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Delete any existing zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  If zipFile.Exists Then</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zipFile.Delete()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End If</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Create a logical zip archive around the zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zip As New ZipArchive(zipFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Disable the use of any OEM code page mandated by the local machine policy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  zip.UseLocalMachineOEMCodePageForFilenames = False</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Specify the &#x27;_&#x27; character for characters that can&#x27;t be converted</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  zip.UnknownCharacterFallbackConversion = &amp;H5f &#x27; &#x27;_&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim destinationPath As String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim sourceFile As AbstractFile = New DiskFile(&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using batch As New AutoBatchUpdate(zip)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * without issue by any editor. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithNonASCIIStart&quot; &amp; ChrW(&amp;H00C0).ToString() &amp; ChrW(&amp;H00C9).ToString() &amp; ChrW(&amp;H044F).ToString() &amp; ChrW(&amp;H30C6).ToString() &amp; &quot;End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Dim destinationFile As ZippedFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27; The string &quot;My comment&quot; in Japanese</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile.Comment = ChrW(&amp;H79C1).ToString() &amp; ChrW(&amp;H306E).ToString() &amp; ChrW(&amp;H30B3).ToString() &amp; ChrW(&amp;H30E1).ToString() &amp; ChrW(&amp;H30F3).ToString() &amp; ChrW(&amp;H30C8).ToString()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithOEMCharsStart����End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End Using</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></div></div></details>
<p>Windows Explorer now displays all the files. The name of &quot;FileNameWithNonASCIIStartÀÉяテEnd.dat&quot; is still mangled but at least it can be extracted now. Other Zip tools, like WinZip, that support Unicode extra headers will continue to display the names properly. Because of this we consider this approach to provide the maximum interoperability while still preserving backward compatibility.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Maximum Interoperability seen in Windows Explorer 7</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Maximum Interoperability seen in Windows Explorer 7" src="/xceed-libs-doc/assets/images/04-3e9e41dc2b7eb6c3a4d87c2e3194d73a.png" width="892" height="327" class="img_ev3q"></p></div></div></details>
<p>On Windows 8, because of the good Unicode support, the archive displays items without issue.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Maximum Interoperability seen in Windows Explorer 8</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Maximum Interoperability seen in Windows Explorer 8" src="/xceed-libs-doc/assets/images/05-da616487a0ebc698917a45ca7ae3fac0.png" width="974" height="430" class="img_ev3q"></p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="unicode-text-encoding">Unicode text encoding<a href="#unicode-text-encoding" class="hash-link" aria-label="Direct link to Unicode text encoding" title="Direct link to Unicode text encoding">​</a></h2>
<p>Some Zip tools do not support Unicode extra headers. They do, however, support Unicode text encoding. Unicode text encoding means that filenames will be written in the zip archive encoded in Unicode (UTF-8) in the main headers.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Code: Create a zip archive using Unicode text encoding</summary><div><div class="collapsibleContent_i85q"><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">C#</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Visual Basic .NET</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">UnicodeTextEncoding</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">/* The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * governed by the rules of your operating system. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> zipFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;UnicodeTextEncoding.zip&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Delete any existing zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Exists </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      zipFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">Delete</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Create a logical zip archive around the zip file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">ZipArchive</span><span class="token plain"> zip </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">ZipArchive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zipFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">/* In this example, we will disable Unicode extra headers to show the effect with zip tools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * that support both Unicode extra headers and Unicode text encoding. But you can enable both</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    * at the same time without issue for increased interoperability. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Disable all types Unicode extra headers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ZipArchive</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DefaultExtraHeaders </span><span class="token operator">=</span><span class="token plain"> ExtraHeaders</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">FileTimes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// Enable writing the meta-data in the main header as Unicode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DefaultTextEncoding </span><span class="token operator">=</span><span class="token plain"> TextEncoding</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Unicode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// By default, the meta-data will always be written in Unicode if the TextEncoding is enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">//zip.DefaultUnicodeUsagePolicy = UnicodeUsagePolicy.Always;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// However, a policy can be enabled where the Unicode encoding will only be enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// if non-ASCII data is detected in the meta-data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">//zip.DefaultUnicodeUsagePolicy = UnicodeUsagePolicy.NonASCIIOnly;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name keyword" style="color:rgb(189, 147, 249);font-style:italic">string</span><span class="token plain"> destinationPath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">AbstractFile</span><span class="token plain"> sourceFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">DiskFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">@&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">using</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token class-name">AutoBatchUpdate</span><span class="token plain"> batch </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name">AutoBatchUpdate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> zip </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">/* We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      * without issue by any editor. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithNonASCIIStart\u00C0\u00C9\u044F\u30C6End.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token class-name">ZippedFile</span><span class="token plain"> destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">// The string &quot;My comment&quot; in Japanese</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Comment </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\u79C1\u306E\u30B3\u30E1\u30F3\u30C8&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationPath </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;FileNameWithOEMCharsStartéàùïEnd.dat&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      destinationFile </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> ZippedFile </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> zip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">GetFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationPath </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      sourceFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">CopyTo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> destinationFile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-vb.NET language-vb.net codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb.net codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Public Shared Sub UnicodeTextEncoding()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       The path and filename of the zip file itself is not covered by the zip specification&#x27;s</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * Unicode support. The name of the zip file is determined by your application and is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * governed by the rules of your operating system. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zipFile As AbstractFile = New DiskFile(&quot;UnicodeTextEncoding.zip&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Delete any existing zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  If zipFile.Exists Then</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    zipFile.Delete()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End If</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Create a logical zip archive around the zip file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim zip As New ZipArchive(zipFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       In this example, we will disable Unicode extra headers to show the effect with zip tools</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * that support both Unicode extra headers and Unicode text encoding. But you can enable both</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;       * at the same time without issue for increased interoperability. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Disable all types Unicode extra headers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ZipArchive.DefaultExtraHeaders = ExtraHeaders.FileTimes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; Enable writing the meta-data in the main header as Unicode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  zip.DefaultTextEncoding = TextEncoding.Unicode</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; By default, the meta-data will always be written in Unicode if the TextEncoding is enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27;zip.DefaultUnicodeUsagePolicy = UnicodeUsagePolicy.Always;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; However, a policy can be enabled where the Unicode encoding will only be enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27; if non-ASCII data is detected in the meta-data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  &#x27;zip.DefaultUnicodeUsagePolicy = UnicodeUsagePolicy.NonASCIIOnly;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim destinationPath As String</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Dim sourceFile As AbstractFile = New DiskFile(&quot;D:\Components\NET40\FileSystem\Dev\Trunk\Tests\UnitTesting\Xceed.Zip.Tests\Data\TinyFile1.txt&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Using batch As New AutoBatchUpdate(zip)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         We use &quot;universal character names&quot; like \u00C0 instead of using character</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * literals so that the code source file remains an ASCII file and can be read</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&#x27;         * without issue by any editor. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithNonASCIIStart&quot; &amp; ChrW(&amp;H00C0).ToString() &amp; ChrW(&amp;H00C9).ToString() &amp; ChrW(&amp;H044F).ToString() &amp; ChrW(&amp;H30C6).ToString() &amp; &quot;End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Dim destinationFile As ZippedFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27; The string &quot;My comment&quot; in Japanese</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile.Comment = ChrW(&amp;H79C1).ToString() &amp; ChrW(&amp;H306E).ToString() &amp; ChrW(&amp;H30B3).ToString() &amp; ChrW(&amp;H30E1).ToString() &amp; ChrW(&amp;H30F3).ToString() &amp; ChrW(&amp;H30C8).ToString()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationPath = &quot;FileNameWithOEMCharsStart����End.dat&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    destinationFile = CType(zip.GetFile(destinationPath), ZippedFile)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sourceFile.CopyTo(destinationFile, True)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  End Using</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">End Sub</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></div></div></details>
<p>The 7-Zip tool supports Unicode text encoding but not Unicode extra headers. When the zip file is viewed in the 7-Zip tool, the items are shown correctly.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Unicode text encoding seen in 7-Zip</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Unicode text encoding seen in 7-Zip" src="/xceed-libs-doc/assets/images/06-0a2ff5c9e79308c768951b9600874996.png" width="801" height="248" class="img_ev3q"></p></div></div></details>
<p>However when the zip file is viewed in Windows Explorer on Windows 7, we see the disadvantage of the Unicode text encoding options. It is not backwards compatible with tools that do not support it. Windows Explorer rightly expects to read file names encoded in the OEM code page because it&#x27;s the only thing it knows about. But the main header file name field has been written in Unicode instead. So the filename shows up mangled.</p>
<p>Comparatively, the Unicode extra header option is backwards compatible because the extra header mechanism is part of the original Zip specification and, by design, any unknown extra header is ignored. This is how Windows Explorer ignores the Unicode extra headers in previous examples. Here, the Unicode data cannot be ignored because it&#x27;s part of the main header.</p>
<p>For this reason, we do not consider using the Unicode text encoding option good for interoperability and only suggest its use if the situation warrants it.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Unicode text encoding seen in Windows Explorer 7</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Unicode text encoding seen in Windows Explorer 7" src="/xceed-libs-doc/assets/images/07-6edb73da514fc08c095ec60ad94b82e2.png" width="892" height="327" class="img_ev3q"></p></div></div></details>
<p>Windows Explorer in Windows 8, with its improved Unicode support, correctly handles the Unicode text encoding and the items show up as they should.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Image: Unicode text encoding seen in Windows Explorer 8</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Unicode text encoding seen in Windows Explorer 8" src="/xceed-libs-doc/assets/images/08-3852eb83bfc2f67a26f24cbd85634243.png" width="976" height="430" class="img_ev3q"></p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusions--best-practices">Conclusions &amp; best practices<a href="#conclusions--best-practices" class="hash-link" aria-label="Direct link to Conclusions &amp; best practices" title="Direct link to Conclusions &amp; best practices">​</a></h2>
<p>Because of the different Unicode options available and the awkward way they were introduced in the Zip specification, there is no universal, full-proof way to support non-ASCII characters in zip file meta data.</p>
<p>If you are producing zip files meant to be consumed by Xceed Zip for .NET or another Zip component sold by Xceed Inc., the default behavior of the component is adequate and no special option needs to be enabled.</p>
<p>If your zip files will be consumed by 3rd party zip tools, make a few tests using the examples above to determine what Unicode options they support and tailor your code to use the Unicode options that best fit the 3rd party tool.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/xceed-libs-doc/zip/basic-concepts/optimizing-batch-updates-to-folder"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Optimizing Batch Updates to a Folder</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/xceed-libs-doc/zip/basic-concepts/aes-ecryption"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AES Encryption</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types-of-unicode-support-for-zip-archives-with-xceed-zip-components" class="table-of-contents__link toc-highlight">Types of Unicode support for zip archives with Xceed Zip components</a></li><li><a href="#unicode-interoperability" class="table-of-contents__link toc-highlight">Unicode interoperability</a></li><li><a href="#zip-archives-created-by-3rd-party-zip-tools-extracted-by-xceed-zip-for-net" class="table-of-contents__link toc-highlight">Zip archives created by 3rd party zip tools extracted by Xceed Zip for .NET</a></li><li><a href="#zip-archives-created-by-xceed-zip-for-net-extracted-by-3rd-party-zip-tools" class="table-of-contents__link toc-highlight">Zip archives created by Xceed Zip for .NET extracted by 3rd party zip tools</a></li><li><a href="#default-behavior" class="table-of-contents__link toc-highlight">Default behavior</a></li><li><a href="#maximum-interoperability" class="table-of-contents__link toc-highlight">Maximum interoperability</a></li><li><a href="#unicode-text-encoding" class="table-of-contents__link toc-highlight">Unicode text encoding</a></li><li><a href="#conclusions--best-practices" class="table-of-contents__link toc-highlight">Conclusions &amp; best practices</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">All rights reserved 2020 - 2024 © Xceed Software Inc.</div></div></div></footer></div>
</body>
</html>